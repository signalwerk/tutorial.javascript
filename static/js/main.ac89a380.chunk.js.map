{"version":3,"sources":["Components/Preview/index.tsx","Components/WorkSpace/index.tsx","Components/Callout/index.tsx","Components/StatusIcon/index.tsx","Components/Markdown/index.tsx","util/usePrevious.ts","util/useFetch.ts","context/session.tsx","context/course.tsx","util/api.js","Components/CapterMenu/index.tsx","Components/StepMenu/index.tsx","Components/Track/index.tsx","Components/VideoPlayer/index.tsx","Components/TextPlayer/index.tsx","Components/VideoPlayer/useVideojs.tsx","Components/Player/index.tsx","Components/Editor/index.tsx","Components/Content/index.tsx","Components/Viewer/index.tsx","Components/Debug/index.tsx","Components/Button/index.tsx","Components/Admin/index.tsx","Components/Version/index.tsx","Components/Home/index.tsx","reportWebVitals.ts","index.tsx","Components/Editor/editor.jsx"],"names":["boxList","textList","renderError","Preview","code","check","hideErrors","themeNetative","solved","useState","boxes","setBoxes","texts","setTexts","error","setError","Box","x","y","width","height","print","text","conzole","log","hasBox","filter","item","found","length","hasText","complete","status","useEffect","Function","e","name","message","runCodeWithDateFunction","render","className","viewBox","fill","xmlns","textAnchor","map","index","JSON","stringify","WorkSpace","children","preview","focus","Callout","done","next","to","StatusIcon","obj2jsx","token","key","type","mdTypes","INLINE_CODE","value","EMPHASIS","STRONG","LINK","href","url","target","rel","TEXT","Markdown","tokens","fromMarkdown","usePrevious","ref","useRef","current","initialState","data","isLoading","fetchReducer","state","action","payload","useFetch","Action","options","previousUrl","useReducer","dispatch","getFetchResult","useCallback","a","fetch","then","response","ok","json","Error","statusText","catch","loading","hasError","editor","selection","start","end","content","progress","reducer","SET_CURRENT_STEP_PROGRESS","chapter","step","newPorgress","set","SET_CURRENT_CHAPTER_PROGRESS","SET_PROGRESS","SET_EDITOR_CONTENT","SET_EDITOR_SELECTION","SET_EDITOR_FOCUS","Context","createContext","Provider","localStorage","getItem","parse","setItem","base","process","REACT_APP_DEV","pkg","homepage","URL","course","movie","ROUTE","chapters","lang","ADD_LANG","SET_CHAPTERS","CapterMenuItem","active","CapterMenu","useContext","SessionContext","appState","CourseContext","useParams","id","title","StepMenuItem","StepMenu","steps","Track","max","onChange","min","Math","round","values","renderTrack","props","style","renderThumb","VideoPlayer","PartType","update","onTimeUpdate","src","isPlaying","setPlaying","isMuted","setMute","duration","setDuration","durationFormat","setDurationFormat","playPosition","setPlayPosition","isInitial","setInitial","player","updatePosition","pos","videoNodeRef","autoplay","onReady","onPlay","onPause","onSeeking","onLoadedmetadata","onSeeked","onEnd","previousSrc","previousAutoplay","_initPlayer","_initPlayerEvents","_changeSrc","_unregisterEvents","undefined","_changeAutoplay","videojs","currentTime","previousTime","position","ready","on","off","one","completeTime","floor","useVideojs","controls","responsive","bigPlayButtonCentered","html5","hls","overrideNative","nativeAudioTracks","nativeVideoTracks","p","totalTime","togglePlayback","pause","play","playPositionFormat","formatTime","data-vjs-player","t","timestamp","onClick","muted","showPart","part","MARK","TEXT_SELECTED","showLines","hasCursor","offset","split","line","parts","slice","lineIndex","partIndex","TextPlayer","styles","highlight","dangerouslySetInnerHTML","__html","languages","js","aria-hidden","Player","setPos","editorFrames","editorFramePosPos","array","predicate","l","findLastIndex","time","editorFramePos","Editor","inputEl","preClassName","textareaClassName","onFocus","SessionAction","onBlur","onSelect","selectionStart","selectionEnd","onValueChange","val","Content","findNextIndex","findIndex","Viewer","chapterURL","currentStepData","find","currentStepProgress","isSolved","nextStepIndex","nextChapterIndex","finished","completeSteps","isChapterComplete","match","task","regexParts","RegExp","test","instruction","Button","srcBlob","audio","createObjectURL","event","saveAs","LiveStreamPreview","stream","videoPreviewRef","React","srcObject","autoPlay","record","Admin","recording","setRecording","setPreview","useMediaRecorder","blobOptions","audioBitsPerSecond","videoBitsPerSecond","mediaStreamConstraints","video","mediaBlob","stopRecording","getMediaStream","clearMediaStream","startRecording","liveStream","now","Date","push","reader","FileReader","readAsDataURL","onloadend","base64dataURI","result","toString","base64data","substr","indexOf","method","body","console","fillRule","clipRule","d","fillOpacity","version","Intl","DateTimeFormat","year","month","day","hour","minute","format","parseInt","replace","Version","Home","reportWebVitals","onPerfEntry","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","exact","path","Debug","document","getElementById","KEYCODE_Z","KEYCODE_BRACKETS","KEYCODE_QUOTE","KEYCODE_BACK_QUOTE","HISTORY_LIMIT","HISTORY_TIME_GAP","isWindows","global","navigator","platform","isMacLike","cssText","capture","_recordCurrentState","input","_input","_recordChange","_getLines","substring","overwrite","_history","stack","count","extras","last","re","previous","pop","startsWith","_updateInput","_applyEdits","_undoEdit","_redoEdit","_handleKeyDown","tabSize","insertSpaces","ignoreTabKey","onKeyDown","defaultPrevented","keyCode","blur","tabCharacter","repeat","preventDefault","shiftKey","linesBeforeCaret","startLine","endLine","nextValue","i","join","startLineText","updatedSelection","hasSelection","endsWith","matches","indent","chars","metaKey","ctrlKey","altKey","setState","_handleChange","this","history","session","padding","textareaId","autoFocus","disabled","form","maxLength","minLength","placeholder","readOnly","required","onKeyUp","rest","contentStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","highlighted","container","c","textarea","autoCapitalize","autoComplete","autoCorrect","spellCheck","data-gramm","defaultProps","textAlign","boxSizing","overflow","top","left","resize","color","MozOsxFontSmoothing","WebkitFontSmoothing","WebkitTextFillColor","pointerEvents","margin","border","background","display","fontFamily","fontSize","fontStyle","fontVariantLigatures","fontWeight","letterSpacing","lineHeight","textIndent","textRendering","textTransform","whiteSpace","wordBreak","overflowWrap"],"mappings":"4bAoBIA,EAAiB,GACjBC,EAAmB,GACnBC,EAAc,GAqKHC,MAnKf,YAMkB,IALhBC,EAKe,EALfA,KACAC,EAIe,EAJfA,MACAC,EAGe,EAHfA,WACAC,EAEe,EAFfA,cACAC,EACe,EADfA,OAEA,EAA0BC,mBAAgB,IAA1C,mBAAOC,EAAP,KAAcC,EAAd,KACA,EAA0BF,mBAAiB,IAA3C,mBAAOG,EAAP,KAAcC,EAAd,KACA,EAA0BJ,mBAAS,IAAnC,mBAAOK,EAAP,KAAcC,EAAd,KAEA,SAASC,IAA8C,IAA1CC,EAAyC,uDAArC,EAAGC,EAAkC,uDAA9B,EAAGC,EAA2B,uDAAnB,IAAKC,EAAc,uDAAL,IAC/CpB,EAAO,sBACFA,GADE,CAEL,CACEiB,EAAGA,EACHC,EAAGA,EACHC,QACAC,YAKN,SAASC,IAAkB,IAAZC,EAAW,uDAAJ,GACpBrB,EAAQ,sBAAOA,GAAP,CAAiBqB,IAG3B,IAAMC,EAAU,CACdC,IAAK,WAAgB,IAAfF,EAAc,uDAAP,GACXrB,EAAQ,sBAAOA,GAAP,CAAiBqB,MAI7B,SAASG,EAAOR,EAAYC,EAAYC,EAAgBC,GACtD,OAAOpB,EAAQ0B,QAAO,SAACC,GACrB,IAAIC,GAAQ,EAiBZ,OAfIX,IACFW,EAAQD,EAAKV,IAAMA,GAEjBC,IACFU,EAAQD,EAAKT,IAAMA,GAGjBC,IACFS,EAAQD,EAAKR,QAAUA,GAGrBC,IACFQ,EAAQD,EAAKP,SAAWA,GAGnBQ,KACNC,OAGL,SAASC,EAAQJ,GACf,OAAOzB,EAASyB,OAAOA,GAAQG,OAGjC,SAASE,EAASC,GACZxB,GACFA,EAAOwB,GA4CX,OAVAC,qBAAU,WACRjC,EAAU,GACVC,EAAW,GACXC,EAAc,GAjCD,SAACE,EAAcC,GACvBD,GAGL,SAAiCA,GAG/B,IACS8B,SAAS,aAAe9B,EAAO,MAA/B8B,GACLlB,EACAK,EACAI,EACAK,EACAC,EACAR,GAEF,MAAOY,GACPJ,GAAS,GACT7B,EAAciC,EAAEC,KAAO,KAAOD,EAAEE,SAKpCC,CAAwB,+DAAD,OAC0ClC,EAD1C,aAEnBC,GAAgB,GAFG,SAWvBkC,CAAOnC,EAAMC,GACbM,EAASX,GACTa,EAASZ,GACTc,EAASb,KACR,CAACE,EAAMC,IAGR,sBAAKmC,UAAWjC,EAAgB,4BAA8B,UAA9D,UACE,qBAAKiC,UAAU,gBAAf,SACE,sBACErB,MAAM,MACNC,OAAO,MACPqB,QAAQ,oBACRC,KAAK,OACLC,MAAM,6BALR,UAOE,sBAAMH,UAAU,uBAAuBrB,MAAM,MAAMC,OAAO,QAE1D,sBAAMoB,UAAU,iBAAiBI,WAAW,MAAM3B,EAAE,MAAMC,EAAE,KAA5D,gBAICR,EAAMmC,KAAI,SAAClB,EAAMmB,GAAP,OACT,sBAEEN,UAAU,YACVvB,EAAGU,EAAKV,EACRC,EAAGS,EAAKT,EACRC,MAAOQ,EAAKR,MACZC,OAAQO,EAAKP,QALR0B,WAeZlC,EAAMiB,OAAS,GACd,qBAAKW,UAAU,wBAAf,SACE,8BACG5B,EAAMiC,KAAI,SAACvB,EAAMwB,GAAP,OACT,iCACGC,KAAKC,UAAU1B,GACf,OAFQwB,UAQlBhC,IAAUR,GACT,sBAAKkC,UAAU,iBAAf,UACE,iFACA,qBAAKA,UAAU,iBAAf,SACE,+BAAO1B,aC7IJmC,MAxBf,YAOoB,IANlBC,EAMiB,EANjBA,SACAC,EAKiB,EALjBA,QACA9C,EAIiB,EAJjBA,MACAC,EAGiB,EAHjBA,WACA8C,EAEiB,EAFjBA,MACA5C,EACiB,EADjBA,OAEA,OACE,sBAAKgC,UAAS,iCAA4BY,EAAQ,QAAU,QAA5D,UACE,qBAAKZ,UAAU,mBAAf,SAAmCU,IACnC,qBAAKV,UAAU,qBAAf,SACE,cAAC,EAAD,CACEpC,KAAM+C,EACN9C,MAAOA,EACPC,WAAYA,EACZC,eAAe,EACfC,OAAQA,U,cCJH6C,MAjBf,YAA0D,IAAvCH,EAAsC,EAAtCA,SAAUI,EAA4B,EAA5BA,KAAMC,EAAsB,EAAtBA,KACjC,OACE,sBAAKf,UAAS,2BAAsBc,EAAO,OAAS,QAApD,UACGJ,GAES,IAATI,GACC,cAAC,IAAD,CAAME,GAAID,EAAV,SACE,sBAAKf,UAAU,gBAAf,UACE,qBAAKA,UAAU,uCACf,oBAAIA,UAAU,qBAAd,yC,MCRGiB,MARf,WACE,OACE,sBAAMjB,UAAS,8BAAf,SACE,sBAAMA,UAAS,oB,iBCEfkB,G,MAAU,SAAVA,EAAWC,EAAgBC,GAC/B,OAAQD,EAAME,MACZ,KAAKC,UAAQC,YACX,OAAO,+BAAiBJ,EAAMK,OAAZJ,GACpB,KAAKE,UAAQG,SACb,KAAKH,UAAQI,OACX,OACE,6BACGP,EAAMT,SAASL,KAAI,SAAClB,EAAMmB,GAAP,OAAiBY,EAAQ/B,EAAMmB,OAD5Cc,GAIb,KAAKE,UAAQK,KACX,OACE,mBAAaC,KAAMT,EAAMU,IAAKC,OAAO,SAASC,IAAI,aAAlD,gBACGZ,QADH,IACGA,OADH,EACGA,EAAOT,SAASL,KAAI,SAAClB,EAAMmB,GAAP,OAAiBY,EAAQ/B,EAAMmB,OAD9Cc,GAIZ,KAAKE,UAAQU,KACX,OACE,sBAAMhC,UAAU,iBAAhB,SACGmB,EAAMK,OAD6BJ,GAI1C,QACE,OAAO,+DAYEa,EARE,SAAC,GAA6B,IAA3BnD,EAA0B,EAA1BA,KACZoD,EAASC,IAAarD,GAC5B,OACE,sBAAMkB,UAAU,WAAhB,SACGkC,GAAUA,EAAO7B,KAAI,SAACc,EAAOb,GAAR,OAAkBY,EAAQC,EAAOb,S,yBCtC9C,SAAS8B,EAAYZ,GAClC,IAAMa,EAAMC,mBAMZ,OAJA7C,qBAAU,WACR4C,EAAIE,QAAUf,IACb,CAACA,IAEGa,EAAIE,QCeb,IAAMC,EAA6B,CACjCC,KAAM,KACNC,WAAW,EACXpE,MAAO,MAKHqE,EAA6B,SAACC,EAAOC,GACzC,OAAQA,EAAOxB,MACb,IAAK,cACH,MAAO,CAAEoB,KAAM,KAAMC,WAAW,EAAMpE,MAAO,MAE/C,IAAK,gBACH,MAAO,CAAEmE,KAAMI,EAAOC,QAASJ,WAAW,EAAOpE,MAAO,MAG1D,IAAK,cACH,MAAO,CAAEmE,KAAM,KAAMC,WAAW,EAAOpE,MAAOuE,EAAOC,SAEvD,QACE,OAAOF,IA+CEG,IClFVC,EDkFUD,EA3Cf,SAA+BlB,EAAaoB,GAC1C,IAAMC,EAAcd,EAAYP,GAEhC,EAA0BsB,qBACxBR,EACAH,GAFF,mBAAOI,EAAP,KAAcQ,EAAd,KAKMC,EAAiBC,sBAAW,sBAAC,sBAAAC,EAAA,sDACjCH,EAAS,CAAE/B,KAAM,gBAEjBmC,MAAM3B,EAAKoB,GACRQ,MAAK,SAACC,GACL,GAAIA,EAASC,GACX,OAAOD,EAASE,OAEhB,MAAM,IAAIC,MAAMH,EAASI,eAG5BL,MAAK,SAAChB,GACLW,EAAS,CAAE/B,KAAM,gBAAiByB,QAAUL,OAE7CsB,OAAM,WACLX,EAAS,CAAE/B,KAAM,cAAeyB,SAAS,OAfZ,2CAiBhC,CAACjB,IAOJ,OALApC,qBAAU,WACR4D,MACC,CAACxB,IAGAqB,IAAgBrB,EACX,CAAE6B,SAAU,KAAMM,SAAS,EAAMC,UAAU,GAG7C,CACLP,SAAUd,EAAMH,KAChBuB,QAASpB,EAAMF,UACfuB,SAAUrB,EAAMtE,Q,wCC9Ef0E,K,4BAAAA,E,sDAAAA,E,4DAAAA,E,wCAAAA,E,4CAAAA,E,qCAAAA,M,KAuFL,ICvFKA,EDuFCR,EAAsB,CAC1BD,QAAS,CACP2B,OAAQ,CACNC,UAAW,CAAEC,MAAO,EAAGC,IAAK,GAC5BC,QAAS,GACT1D,OAAO,IAGX2D,SAAU,IAyBNC,EAAmC,SAAC5B,EAAOC,GAC/C,OAAQA,EAAOxB,MACb,KAAK2B,EAAOyB,0BACV,OAAQ,WACN,MAAiC5B,EAAOC,QAAhC4B,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,KAAMnD,EAAvB,EAAuBA,MACjBoD,EAAcC,cAClB,eAAKjC,EAAM2B,WAAc,GACzB,CAACG,EAAS,QAASC,EAAM,QACzBnD,GAGF,OAAO,2BACFoB,GADL,IAEE2B,SAAS,eACJK,KAXD,GAeV,KAAK5B,EAAO8B,6BACV,OAAQ,WACN,MAA2BjC,EAAOC,QAA1B4B,EAAR,EAAQA,QAASlD,EAAjB,EAAiBA,MACXoD,EAAcC,cAClB,eAAKjC,EAAM2B,WAAc,GACzB,CAACG,EAAS,QACVlD,GAGF,OAAO,2BACFoB,GADL,IAEE2B,SAAS,eACJK,KAXD,GAgBV,KAAK5B,EAAO+B,aACV,OAAQ,WACN,IAAQR,EAAa1B,EAAOC,QAApByB,SAER,OAAO,2BACF3B,GADL,IAEE2B,SAAS,2BACJ3B,EAAM2B,UACNA,KAPD,GAYV,KAAKvB,EAAOgC,mBACV,OAAQ,WACN,MAAiCnC,EAAOC,QAAhC4B,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,KAAMnD,EAAvB,EAAuBA,MACjBoD,EAAcC,cAClB,eAAKjC,EAAM2B,WAAc,GACzB,CAACG,EAAS,QAASC,EAAM,SAAU,WACnCnD,GAGF,OAAO,2BACFoB,GADL,IAEEL,QAAQ,2BACHK,EAAML,SADJ,IAEL2B,OAAO,2BACFtB,EAAML,QAAQ2B,QADb,IAEJI,QAAS9C,MAGb+C,SAAS,eACJK,KAlBD,GAuBV,KAAK5B,EAAOiC,qBACV,OAAQ,WACN,IAAQzD,EAAUqB,EAAOC,QAAjBtB,MAER,OAAO,2BACFoB,GADL,IAGEL,QAAQ,2BACHK,EAAML,SADJ,IAEL2B,OAAO,2BACFtB,EAAML,QAAQ2B,QADb,IAEJC,UAAW3C,QAVX,GAgBV,KAAKwB,EAAOkC,iBACV,OAAQ,WACN,IAAQ1D,EAAUqB,EAAOC,QAAjBtB,MAER,OAAO,2BACFoB,GADL,IAEEL,QAAQ,2BACHK,EAAML,SADJ,IAEL2B,OAAO,2BACFtB,EAAML,QAAQ2B,QADb,IAEJtD,MAAOY,QATP,KAoBR2D,EAAUC,wBAGb,CACDxC,MAAOJ,EACPY,SAAU,kBAAM,QAGZiC,EAAqB,SAAC,GAAkB,IAAhB3E,EAAe,EAAfA,SAC5B,EAA0ByC,qBAAWqB,EAAShC,GAA9C,mBAAOI,EAAP,KAAcQ,EAAd,KAsBA,OAnBA3D,qBAAU,WACR,GAAI6F,aAAc,CAChB,IAAMf,EAAWe,aAAaC,QAAQ,oBAElChB,GACFnB,EAAS,CACP/B,KAAM2B,EAAO+B,aACbjC,QAAS,CACPyB,SAAUhE,KAAKiF,MAAMjB,SAK5B,IAEH9E,qBAAU,WACR6F,aAAaG,QAAQ,mBAAoBlF,KAAKC,UAAUoC,EAAM2B,aAC7D,CAAC3B,EAAM2B,WAGR,cAACY,EAAQE,SAAT,CAAkB7D,MAAO,CAAEoB,QAAOQ,YAAlC,SAA+C1C,K,QE9Q7CgF,EAAOC,gMAAYC,cAAZ,UACNC,EAAIC,UADE,UAENH,+BAEMI,EAAM,CACjBC,OAAO,GAAD,OAAKN,EAAL,oCACNhB,QAAS,gBAAGA,EAAH,EAAGA,QAAH,gBACJgB,EADI,wCACgChB,EADhC,UAETC,KAAM,gBAAGD,EAAH,EAAGA,QAASC,EAAZ,EAAYA,KAAZ,gBACDe,EADC,wCACmChB,EADnC,YAC8CC,EAD9C,UAENsB,MAAO,gBAAGvB,EAAH,EAAGA,QAASC,EAAZ,EAAYA,KAAZ,4EAC0DD,EAD1D,YACqEC,EADrE,oBAIIuB,EACO,gBAAGxB,EAAH,EAAGA,QAAH,iCAAqCA,EAArC,cADPwB,EAEL,gBAAGxB,EAAH,EAAGA,QAASC,EAAZ,EAAYA,KAAZ,iCAA2CD,EAA3C,YAAsDC,K,SDRzD3B,K,oBAAAA,E,6BAAAA,M,KA0CL,IAAMR,EAAsB,CAC1B2D,SAAU,GACVC,KAAM,IAGF5B,EAAmC,SAAC5B,EAAOC,GAC/C,OAAQA,EAAOxB,MACb,KAAK2B,EAAOqD,SACV,OAAQ,WACN,IAAQD,EAASvD,EAAOC,QAAhBsD,KAER,OAAO,2BACFxD,GADL,IAEEwD,KAAK,2BACAxD,EAAMwD,MACNA,KAPD,GAWV,KAAKpD,EAAOsD,aACV,OAAQ,WACN,IAAQH,EAAatD,EAAOC,QAApBqD,SAER,OAAO,2BACFvD,GADL,IAEEuD,aALI,KAcRhB,EAAUC,wBAGb,CACDxC,MAAOJ,EACPY,SAAU,kBAAM,QAGZiC,EAAqB,SAAC,GAAkB,IAAhB3E,EAAe,EAAfA,SAC5B,EAA0ByC,qBAAWqB,EAAShC,GAA9C,mBAAOI,EAAP,KAAcQ,EAAd,KAoCA,OAlCA3D,qBAAU,WAGR+D,MAAMuC,EAAIC,QACPvC,MAAK,SAACC,GACL,GAAIA,EAASC,GACX,OAAOD,EAASE,OAEhB,MAAM,IAAIC,MAAMH,EAASI,eAG5BL,MAAK,SAAChB,GACDA,IACFW,EAAS,CACP/B,KAAM2B,EAAOsD,aACbxD,QAAS,CACPqD,SAAU1D,EAAK0D,YAGnB/C,EAAS,CACP/B,KAAM2B,EAAOqD,SACbvD,QAAS,CACPsD,KAAM3D,EAAK2D,cAUpB,CAACL,EAAIC,SAGN,cAAC,EAAQX,SAAT,CAAkB7D,MAAO,CAAEoB,QAAOQ,YAAlC,SAA+C1C,K,MEzGnD,SAAS6F,EAAT,GAA0E,IAAhD7F,EAA+C,EAA/CA,SAAUI,EAAqC,EAArCA,KAAM0F,EAA+B,EAA/BA,OACxC,OACE,qBACExG,UAAS,4BACPwG,EAAS,4BAA8B,8BADhC,YAGP1F,IAAS0F,EAAS,0BAA4B,2BAJlD,SAOG9F,IAmCQ+F,MA9Bf,WACE,IAAQ7D,EAAU8D,qBAAWC,GAArB/D,MACOgE,EAAaF,qBAAWG,GAA/BjE,MACF8B,EAAYoC,cAAZpC,QAEN,OACE,qBAAK1E,UAAU,cAAf,SAEI,qBAAKA,UAAU,oBAAf,SACG4G,EAAST,UACRS,EAAST,SAAS9F,KAAI,SAAClB,GAAD,eACpB,cAACoH,EAAD,CAEEzF,KAAO8B,EAAM2B,WAAN,UAAkB3B,EAAM2B,SAASG,UAAjC,aAAkB,EAAyB5D,QAAS,EAC3D0F,OAAQ9B,IAAYvF,EAAK4H,GAH3B,SAKE,eAAC,IAAD,CAAM/F,GAAE,2BAAsB7B,EAAK4H,GAA3B,aAAR,UACGnE,EAAM2B,WAAN,UAAkB3B,EAAM2B,SAASpF,EAAK4H,WAAtC,aAAkB,EAAyBjG,OAC1C,cAAC,EAAD,IAED3B,EAAK6H,UARH7H,EAAK4H,Y,MChC1B,SAASE,EAAT,GAAsE,IAA9CvG,EAA6C,EAA7CA,SAAUI,EAAmC,EAAnCA,KAAM0F,EAA6B,EAA7BA,OACtC,OACE,qBACExG,UAAS,0BACPwG,EAAS,0BAA4B,4BAD9B,YAEL1F,IAAS0F,EAAS,wBAA0B,yBAHlD,SAKG9F,IA2CQwG,MAtCf,YAA6C,IAAzBC,EAAwB,EAAxBA,MACVvE,EAAU8D,qBAAWC,GAArB/D,MACR,EAAwBkE,cAAlBnC,EAAN,EAAMA,KAAMD,EAAZ,EAAYA,QAMZ,OACE,qBAAK1E,UAAU,YAAf,SACE,qBAAKA,UAAU,kBAAf,SACGmH,EAAM9G,KAAI,SAAClB,GAAD,mBACT,cAAC8H,EAAD,CAEEnG,KACG8B,EAAM2B,WAAN,UACC3B,EAAM2B,SAASG,UADhB,aACC,EAAyByC,MAAMhI,EAAK4H,OADrC,UAECnE,EAAM2B,SAASG,UAFhB,aAEC,EAAyByC,MAAMhI,EAAK4H,IAAIjG,QAC1C,EAEF0F,OAAQ7B,IAASxF,EAAK4H,GARxB,SAUE,eAAC,IAAD,CACE/G,UAAU,kBACVgB,GAAIkF,EAAW,CAAExB,UAASC,KAAMxF,EAAK4H,KAFvC,UAIGnE,EAAM2B,WAAN,UACC3B,EAAM2B,SAASG,UADhB,aACC,EAAyByC,MAAMhI,EAAK4H,OADrC,UAECnE,EAAM2B,SAASG,UAFhB,aAEC,EAAyByC,MAAMhI,EAAK4H,IAAIjG,OAAQ,cAAC,EAAD,IACjD3B,EAAK6H,UAhBH7H,EAAK4H,Y,gCCNPK,G,OA5BD,SAAC,GAA0C,IAAxCC,EAAuC,EAAvCA,IAAK7F,EAAkC,EAAlCA,MAAO8F,EAA2B,EAA3BA,SAG3B,OACE,qBAAKtH,UAAU,QAAf,SACE,cAAC,QAAD,CACE2E,KAAM,GACN4C,IAAK,EACLF,IAAKG,KAAKC,MAAY,GAANJ,GAAY,GAC5BK,OAAQ,CAAClG,GACT8F,SAAU,SAACI,GAAD,OAAYJ,EAASI,EAAO,KACtCC,YAAa,gBAAGC,EAAH,EAAGA,MAAOlH,EAAV,EAAUA,SAAV,OACX,gDAASkH,GAAT,IAAgB5H,UAAU,eAA1B,UACE,qBACEA,UAAU,gBACV6H,MAAO,CACLlJ,MAAM,GAAD,OAAM,IAAM0I,EAAO7F,EAAnB,QAGRd,OAGLoH,YAAa,gBAAGF,EAAH,EAAGA,MAAH,OAAe,+CAASA,GAAT,IAAgB5H,UAAU,yB,sICsK/C+H,IC1LVC,GD0LUD,GAzLf,YAAuE,IAAlCE,EAAiC,EAA/CC,aAAsBC,EAAyB,EAAzBA,IAC3C,EAAgClK,oBAAS,GAAzC,mBAAOmK,EAAP,KAAkBC,EAAlB,KACA,EAA2BpK,oBAAS,GAApC,mBAAOqK,EAAP,KAAgBC,EAAhB,KACA,EAAgCtK,mBAAS,GAAzC,mBAAOuK,EAAP,KAAiBC,EAAjB,KACA,EAA4CxK,mBAAS,IAArD,mBAAOyK,EAAP,KAAuBC,EAAvB,KACA,EAAwC1K,mBAAS,GAAjD,mBAAO2K,EAAP,KAAqBC,EAArB,KACA,EAAgC5K,oBAAS,GAAzC,mBAAO6K,EAAP,KAAkBC,EAAlB,KAEIC,EAAS1G,iBAA6B,MAEpC2G,EAAiB,SAACC,GACtBjB,EAAOiB,GAAO,GACdL,EAAgBK,GAAO,IASzBzJ,qBAAU,WACRwJ,EAAe,GACfR,EAAY,GACZF,GAAQ,GACRF,GAAW,GACXU,GAAW,KACV,CAACZ,IAEJ,IA0BQgB,EElBH,YAYI,IAGLH,EAdJb,EAWQ,EAXRA,IACAiB,EAUQ,EAVRA,SACAC,EASQ,EATRA,QACAC,EAQQ,EARRA,OACAC,EAOQ,EAPRA,QACArB,EAMQ,EANRA,aACAsB,EAKQ,EALRA,UACAC,EAIQ,EAJRA,iBACAC,EAGQ,EAHRA,SACAC,EAEQ,EAFRA,MACG/B,EACK,mBACFuB,EAAe7G,iBAAO,MAItBsH,EAAcxH,EAAY+F,GAC1B0B,EAAmBzH,EAAYgH,GAErC3J,qBAAU,WACJmK,IAAgBzB,GAAQyB,IAC1BE,IACAC,KAEEH,IAAgBzB,GAAOyB,IACzBI,IACAC,IACAF,KAGEF,IAAqBT,QAAiCc,IAArBL,IACnCM,IACAF,IACAF,OAED,CAAC5B,EAAKiB,IAET,IAAMU,EAAc,YAClBd,EAASoB,YAAQjB,EAAa5G,QAASqF,IAChCO,IAAIA,GACXa,EAAOI,SAASA,IAAY,IAGxBY,EAAa,YACjBhB,EAASoB,YAAQjB,EAAa5G,UACvB4F,IAAIA,IAGPgC,EAAkB,YACtBnB,EAASoB,YAAQjB,EAAa5G,UACvB6G,SAASA,IAAY,IAGxBW,EAAoB,WACxB,IAAIM,EAAc,EACdC,EAAe,EACfC,EAAW,EAEfvB,EAAOwB,OAAM,WACPnB,GACFA,EAAQL,MAIZA,EAAOyB,GAAG,QAAQ,WACZnB,GACFA,EAAON,EAAOqB,kBAIlBrB,EAAOyB,GAAG,SAAS,WACblB,GACFA,EAAQP,EAAOqB,kBAInBrB,EAAOyB,GAAG,cAAc,WAClBvC,IACFA,EAAac,EAAOqB,eACpBC,EAAeD,EACfA,EAAcrB,EAAOqB,cACjBC,EAAeD,IACjBE,EAAWD,EACXA,EAAeD,OAKrBrB,EAAOyB,GAAG,WAAW,WACfjB,IACFR,EAAO0B,IAAI,cACX1B,EAAO2B,IAAI,UACXnB,EAAUR,EAAOqB,mBAIrBrB,EAAOyB,GAAG,kBAAkB,WACtBhB,GACFA,EAAiBT,EAAOR,eAI5BQ,EAAOyB,GAAG,UAAU,WAClB,GAAIf,EAAU,CACZ,IAAMkB,EAAepD,KAAKqD,MAAM7B,EAAOqB,eACvCX,EAASa,EAAUK,OAIvB5B,EAAOyB,GAAG,SAAS,WACbd,GACFA,EAAMX,EAAOqB,mBAKbJ,EAAoB,WACxBjB,EAAO0B,IAAI,QACX1B,EAAO0B,IAAI,SACX1B,EAAO0B,IAAI,cACX1B,EAAO0B,IAAI,WACX1B,EAAO0B,IAAI,UACX1B,EAAO0B,IAAI,UAGb,MAAO,CAAEvB,gBF5GgB2B,CAAW,CAClC3C,MACA4C,UAAU,EACV3B,UAAU,EACV4B,YAAY,EACZC,uBAAuB,EACvBtM,MAAO,IACPC,OAAQ,IACRsM,MAAO,CACLC,IAAK,CACHC,gBAAgB,GAElBC,mBAAmB,EACnBC,mBAAmB,GAErBhC,OAzCa,SAACe,GACdpB,EAAeoB,IAyCfd,QAtCc,SAACc,GACfpB,EAAeoB,IAsCfV,MAnCY,SAACU,GACbhC,GAAW,GACXY,EAAeoB,IAkCfhB,QAtBc,SAACkC,GACfvC,EAAOzG,QAAUgJ,GAsBjBrD,aAhCmB,SAACmC,GACpBxB,EAAgBwB,GAChBpB,EAAeoB,IA+BfZ,iBA7BuB,SAAC+B,GAExB/C,EAAY+C,MAONrC,aAuBFsC,EAAiB,WAGjBzC,EAAOzG,UACT8F,GAAYD,GAEPA,EAGHY,EAAOzG,QAAQmJ,QAFf1C,EAAOzG,QAAQoJ,SAoCfC,EAAqBxB,IAAQyB,WACjCrE,KAAKD,IAAIqB,EAAcJ,GACvB,KAUF,OAPA/I,qBAAU,WACRkJ,EAAkByB,IAAQyB,WAAWrD,EAAU,QAC9C,CAACA,IAMF,mCACE,sBAAKxI,UAAU,eAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,qBAAK8L,mBAAA,EAAL,SACE,uBAAOzJ,IAAK8G,QAGhB,sBAAKnJ,UAAU,oBAAf,UACE,qBAAKA,UAAU,sBAAf,WACKwI,GACD,cAAC,EAAD,CACEnB,IAAKmB,EACLhH,MAAOoH,EACPtB,SAAU,SAACyE,GAAD,OAlCHC,EAkC8BD,OA/B7C/C,EAAOzG,SACTyG,EAAOzG,QAAQ8H,YAAY2B,IAJX,IAACA,OAsCb,sBAAKhM,UAAU,wBAAf,YACKwI,GACD,qCACE,wBACExI,UAAS,4BACPoI,EAAY,aAAe,aAE7B6D,QAASR,IAEX,wBACEzL,UAAS,4BACPsI,EAAU,kBAAoB,kBAEhC2D,QAjEG,WAGbjD,EAAOzG,UACTgG,GAASD,GAEJA,EAGHU,EAAOzG,QAAQ2J,OAAM,GAFrBlD,EAAOzG,QAAQ2J,OAAM,UA8DjB,sBAAKlM,UAAU,qBAAf,UACG4L,EADH,MAC0BlD,aAI3BF,GAAYM,GACb,qBAAK9I,UAAU,0BAAf,SACE,wBAAQiM,QAnFI,WAChBjD,EAAOzG,UACTwG,GAAW,GACX0C,MAgFM,SACE,sBAAMzL,UAAU,wB,uDCjLzBgI,K,YAAAA,E,YAAAA,E,+BAAAA,Q,KAaL,IAAMmE,GAAW,SAACC,GAChB,OAAQA,EAAK/K,MACX,KAAK2G,GAAShG,KACZ,OAAO,sBAAMhC,UAAU,kBAAhB,SAAmCoM,EAAK5K,QACjD,KAAKwG,GAASqE,KACZ,OAAO,sBAAMrM,UAAU,kBAAhB,oBACT,KAAKgI,GAASsE,cACZ,OAAO,sBAAMtM,UAAU,sBAAhB,SAAuCoM,EAAK5K,UAOnD+K,GAAY,SAAC3O,EAAcwG,EAAeC,GAC9C,IAAMmI,EAAYpI,IAAUC,EACxBoI,EAAS,EAgFb,OA/EsB7O,EAAK8O,MAAM,MAAMrM,KAAI,SAACsM,GAC1C,IAAIC,EAAQ,KA2EZ,OArEIA,EAHAJ,EAEEpI,GAASqI,GAAUpI,GAAOoI,EAASE,EAAKtN,OAClC,CACN,CACEgC,KAAM2G,GAAShG,KACfR,MAAOmL,EAAKE,MAAM,EAAGzI,EAAQqI,IAE/B,CACEpL,KAAM2G,GAASqE,KACf7K,MAAO,IAET,CACEH,KAAM2G,GAAShG,KACfR,MAAOmL,EAAKE,MAAMxI,EAAMoI,KAMpB,CACN,CACEpL,KAAM2G,GAAShG,KACfR,MAAOmL,IAQTvI,GAASqI,GAAUpI,EAAMoI,EACnB,CACN,CACEpL,KAAM2G,GAASsE,cACf9K,MAAOmL,EAAKE,MAAM,EAAGxI,EAAMoI,IAE7B,CACEpL,KAAM2G,GAAShG,KACfR,MAAOmL,EAAKE,MAAMxI,EAAMoI,KAKrBrI,GAASqI,GAAUrI,EAAQqI,EAASE,EAAKtN,OACxC,CACN,CACEgC,KAAM2G,GAAShG,KACfR,MAAOmL,EAAKE,MAAM,EAAGzI,EAAQqI,IAE/B,CACEpL,KAAM2G,GAASsE,cACf9K,MAAOmL,EAAKE,MAAMzI,EAAQqI,EAAQpI,EAAMoI,IAE1C,CACEpL,KAAM2G,GAAShG,KACfR,MAAOmL,EAAKE,MAAMxI,EAAMoI,EAAQE,EAAKtN,UAMjC,CACN,CACEgC,KAAM2G,GAAShG,KACfR,MAAOmL,IAMfF,GAAUE,EAAKtN,OAAS,EACjBuN,KAGIvM,KAAI,SAACsM,EAAYG,GAAb,OACf,8BACE,+BACGH,EAAKtM,KAAI,SAAC+L,EAAMW,GAAP,OACR,+BACGZ,GAASC,IADZ,eAAmBU,EAAnB,iBAAqCC,UAH3C,eAAkBD,QAwCPE,OA5Bf,YAAkD,IAA5B9I,EAA2B,EAA3BA,OACpB,OACE,sBAAKlE,UAAU,mBAAf,UACE,qBACEA,UAAU,yBACV6H,MAAK,2BAAOoF,KAAO/I,QAAW+I,KAAOC,WAEnCC,wBAAyB,CACvBC,OAAQF,qBAAUhJ,EAAOI,QAAS+I,aAAUC,IAAM,YAIxD,qBACEtN,UAAU,yBACV6H,MAAK,2BAAOoF,KAAO/I,QAAW+I,KAAOC,WACrCK,cAAY,OAHd,SAKGrJ,GACCqI,GACErI,EAAOI,QACPJ,EAAOC,UAAUC,MACjBF,EAAOC,UAAUE,WEjFdmJ,OA5Cf,WACE,IACWpH,EACPM,qBAAWG,GADbjE,MAASwD,KAEX,EAAwBU,cAAlBpC,EAAN,EAAMA,QAASC,EAAf,EAAeA,KAEf,EAAsB1G,mBAAS,GAA/B,mBAAOiL,EAAP,KAAYuE,EAAZ,KAIA,EAA6C1K,EAC3CgD,EAAIpB,KAAK,CAAED,UAASC,UADJ+I,EAAlB,EAAQhK,SAAwBO,EAAhC,EAAgCA,SAI1B0J,EAAoBD,EAzBrB,SACLE,EACAC,GAGA,IADA,IAAIC,EAAIF,EAAMvO,OACPyO,KACL,GAAID,EAAUD,EAAME,GAAIA,EAAGF,GAAQ,OAAOE,EAE5C,OAAQ,EAkBJC,CAAcL,GAAc,SAACvO,GAAD,OAAUA,EAAK6O,MAAc,IAAN9E,KACnD,EAEE+E,IAAiBP,GAAeA,EAAaC,GAEnD,OACE,qBAAK3N,UAAU,SAAf,SACE,sBAAKA,UAAU,kBAAf,UACE,qBAAKA,UAAU,gBAAf,SACE,cAAC,GAAD,CACEkI,aAAc,SAAC6D,GAAD,OAAe0B,EAAO1B,IACpC5D,IAAKpC,EAAIE,MAAM,CAAEvB,UAASC,aAG9B,qBAAK3E,UAAU,eAAf,UACKiE,GAAYgK,GACb,cAAC,GAAD,CAAY/J,OAAQ+J,EAAe/J,UAC/B,+BAAOkC,EAAK,mBAEpB,qBAAKpG,UAAU,kBAAf,UACIiE,GAAYgK,GACZ,cAAC,EAAD,CAASrQ,KAAMqQ,EAAe/J,OAAOI,QAASxG,YAAY,YC0FvDoQ,I,OA3IA,SAAC,GAA8B,IAA5B5J,EAA2B,EAA3BA,QACRlB,EAAasD,qBAAWC,GAAxBvD,SACR,EAAwB0D,cAAlBpC,EAAN,EAAMA,QAASC,EAAf,EAAeA,KAETwJ,EAAU7L,iBAA4B,MAE5C7C,qBAAU,WAAO,IAAD,EACP,OAAP0O,QAAO,IAAPA,GAAA,UAAAA,EAAS5L,eAAT,SAAkB3B,UACjB,IA4GH,OACE,qBAAKZ,UAAU,SAAf,SACE,cAAC,KAAD,CACEA,UAAU,sBACVoO,aAAa,uBACbC,kBAAkB,4BAClBC,QAxBW,WACflL,EAAS,CACP/B,KAAMkN,EAAcrJ,iBACpBpC,QAAS,CACPtB,OAAO,MAqBPgN,OAhBU,WACdpL,EAAS,CACP/B,KAAMkN,EAAcrJ,iBACpBpC,QAAS,CACPtB,OAAO,MAaPiN,SAvFkB,SACtB9O,GAIA,IArBqB6B,EAqBf4C,EAAQzE,EAAEmC,OAAO4M,gBAAkB,EACnCrK,EAAM1E,EAAEmC,OAAO6M,cAAgBvK,EAtBhB5C,EAwBP,CAAE4C,QAAOC,OAvBvBjB,EAAS,CACP/B,KAAMkN,EAActJ,qBACpBnC,QAAS,CACPtB,YAoGAoN,cA5FoB,SAACC,GAvBT,IAACrN,IAwBPqN,EAvBVzL,EAAS,CACP/B,KAAMkN,EAAcvJ,mBACpBlC,QAAS,CACP4B,UACAC,OACAnD,YA8GAA,MAAO8C,EACP4I,UAAW,SAACtP,GAAD,OAAUsP,qBAAUtP,EAAMyP,aAAUC,KAC/CzF,MACE,S,OCxIKiH,OAJf,YAA8D,IAA3CpO,EAA0C,EAA1CA,SAA0C,IAAhCV,iBAAgC,MAApB,GAAoB,EAC3D,OAAO,qBAAKA,UAAS,kBAAaA,GAA3B,SAAyCU,KCgB3C,SAASqO,GACdnB,EACAC,GAEA,IAAIC,EAAIF,EAAMvO,OAERiB,EAAQsN,EAAMoB,UAAUnB,GAE9B,OAAIvN,GAAS,GAAKA,EAAQwN,EAAI,EACrBxN,EAAQ,GAGT,EAuJK2O,OApJf,WAAmB,IAAD,UAChB,EAGIvI,qBAAWG,GAFND,EADT,EACEhE,MACSwD,EAFX,EAEExD,MAASwD,KAEX,EAA4BM,qBAAWC,GAA/B/D,EAAR,EAAQA,MAAOQ,EAAf,EAAeA,SACf,EAAwB0D,cAAlBpC,EAAN,EAAMA,QAASC,EAAf,EAAeA,KAETuK,EAAanJ,EAAIrB,QAAQ,CAAEA,YACjC,EAA+C3B,EAAiBmM,GAA9C/H,EAAlB,EAAQzD,SAAiBM,EAAzB,EAAyBA,QAASC,EAAlC,EAAkCA,SAE5BkL,EAAe,OAAGhI,QAAH,IAAGA,OAAH,EAAGA,EAAOiI,MAAK,SAACjQ,GAAD,OAAUA,EAAK4H,KAAOpC,KAEpD0K,EACJzM,EAAM2B,WAAN,UAAkB3B,EAAM2B,SAASG,UAAjC,aAAkB,EAAyByC,MAAMxC,IAE7C2K,EAAQ,OAAGD,QAAH,IAAGA,OAAH,EAAGA,EAAqBvO,KAEhCwD,EACH1B,EAAM2B,WAAN,UAAkB3B,EAAM2B,SAASG,UAAjC,iBAAkB,EAAyByC,MAAMxC,UAAjD,iBAAkB,EAAsCT,cAAxD,aAAkB,EAA8CI,UACjE,GAGEvD,EAAO,GACLwO,EACHpI,GAAS4H,GAAoB5H,GAAO,SAAChI,GAAD,OAAUA,EAAK4H,KAAOpC,MAAU,EACvE,GAAIwC,GAASoI,EAAgB,EAC3BxO,EAAOmF,EAAW,CAAExB,UAASC,KAAMwC,EAAMoI,GAAexI,UACnD,GAAII,GAASzC,EAAS,CAC3B,IAAM8K,EACH5I,EAAST,UACR4I,GACEnI,EAAST,UACT,SAAChH,GAAD,OAAUA,EAAK4H,KAAOrC,MAE1B,EAEEkC,EAAST,UAAYqJ,EAAmB,IAC1CzO,EAAOmF,EAAuB,CAC5BxB,QAASkC,EAAST,SAASqJ,GAAkBzI,MAKnD,IAAM/I,EAAS,SAACyR,GACd,GAAIH,IAAaG,EAAU,CACzBrM,EAAS,CACP/B,KAAMkN,EAAc9J,0BACpB3B,QAAS,CACP4B,UACAC,OACAnD,MAAOiO,KAIX,IAAMC,EAAa,OAAGvI,QAAH,IAAGA,OAAH,EAAGA,EAAOjI,QAAO,SAACC,GAAU,IAAD,IAC5C,OAAIA,EAAK4H,KAAOpC,EACP8K,EAGP7M,EAAM2B,WAAN,UACA3B,EAAM2B,SAASG,UADf,aACA,EAAyByC,MAAMhI,EAAK4H,OADpC,UAEAnE,EAAM2B,SAASG,UAFf,aAEA,EAAyByC,MAAMhI,EAAK4H,IAAIjG,SAItC6O,GAAiC,OAAbD,QAAa,IAAbA,OAAA,EAAAA,EAAerQ,WAAf,OAA0B8H,QAA1B,IAA0BA,OAA1B,EAA0BA,EAAO9H,QAE3D+D,EAAS,CACP/B,KAAMkN,EAAczJ,6BACpBhC,QAAS,CACP4B,UACAlD,MAAOmO,OAoBf,OAdAlQ,qBAAU,WACR,IAAMmQ,EAAK,OAAGT,QAAH,IAAGA,OAAH,EAAGA,EAAiBU,KAAKD,MACpC,GAAIA,GAAStL,EAAS,CACpB,IAAMwL,EAAaF,EAAMA,MAAM,IAAIG,OAAO,uBAC1C,GAA2B,KAAb,OAAVD,QAAU,IAAVA,OAAA,EAAAA,EAAYzQ,QAAc,CAC5B,IAEMoQ,EAFQ,IAAIM,OAAOD,EAAW,GAAIA,EAAW,IAE5BE,KAAK1L,GAE5BtG,EAAOyR,OAGV,CAACnL,IAGF,sBAAKtE,UAAU,SAAf,UACE,qBAAKA,UAAU,uBAAf,SACE,cAAC,EAAD,MAEF,sBAAKA,UAAU,kBAAf,UACE,qBAAKA,UAAU,oBAAf,SACE,sBAAKA,UAAU,0BAAf,UACGmH,GAAS,cAAC,EAAD,CAAUA,MAAOA,IAC1BnD,GAAW,qCAAQoC,EAAK,mBACxBnC,GAAY,qCAAQmC,EAAK,sBAG9B,sBAAKpG,UAAU,eAAf,UACE,qBAAKA,UAAU,gBAAf,SACE,cAAC,GAAD,CAASA,UAAU,sBAAnB,SACE,cAAC,GAAD,QAGJ,qBAAKA,UAAU,eAAf,SACE,cAAC,GAAD,UACE,cAAC,EAAD,CAASc,KAAMwO,IAAY,EAAOvO,KAAMA,EAAxC,SACE,sBAAKf,UAAU,oBAAf,UACE,+BACGsP,GAAY,cAAC,EAAD,IACZlJ,EAAK,gBAER,4BACG+I,GACC,cAAC,EAAD,CAAUrQ,KAAMqQ,EAAgBU,KAAKI,yBAOjD,qBAAKjQ,UAAU,gBAAf,SACE,cAAC,GAAD,WACIgE,GACA,cAAC,EAAD,CACErD,SAA4B,OAAnB0O,QAAmB,IAAnBA,GAAA,UAAAA,EAAqBnL,cAArB,eAA6BI,UAAW,GACjDzG,MAAK,OAAEsR,QAAF,IAAEA,OAAF,EAAEA,EAAiBU,KAAKhS,MAC7BG,OAAQA,EACR4C,MAAOgC,EAAML,QAAQ2B,OAAOtD,MAJ9B,SAME,cAAC,GAAD,CAAQ0D,QAASA,oB,OCrJpB4C,OAtBf,WACE,IAAQtE,EAAU8D,qBAAWC,GAArB/D,MACR,EAAwBkE,cAElBjI,EAAQ,CACZ6F,QAHF,EAAMA,QAIJC,KAJF,EAAeA,KAObR,UAAU,GAAD,OAAKvB,EAAML,QAAQ2B,OAAOC,UAAUC,MAApC,mBAA+CxB,EAAML,QAAQ2B,OAAOC,UAAUE,MAGzF,OACE,sBAAKrE,UAAU,QAAf,UACE,uCACA,qBAAKA,UAAU,OAAf,SACE,+BAAOO,KAAKC,UAAU3B,EAAO,KAAM,W,6BCR5BqR,I,OANA,SAAC,GAAD,IAAGxP,EAAH,EAAGA,SAAUuL,EAAb,EAAaA,QAAb,OACb,wBAAQjM,UAAU,SAASiM,QAASA,EAApC,SACGvL,M,OCQL,SAAS8M,GAAT,GAAqC,IAAnB2C,EAAkB,EAAlBA,QAASC,EAAS,EAATA,MACzB,IAAKD,EACH,OAAO,KAGT,GAAIC,EACF,OAAO,uBAAOjI,IAAKpC,IAAIsK,gBAAgBF,GAAUpF,UAAQ,IAO3D,OACE,8BACE,gCACE,uBACE5C,IAAKpC,IAAIsK,gBAAgBF,GACzBxR,MAAO,IACPC,OAAQ,IACRmM,UAAQ,IAEV,8BACE,cAAC,GAAD,CAAQkB,QAdI,SAACqE,GACnBC,kBAAOJ,EAAS,cAaV,6BAOV,SAASK,GAAT,GAAwC,IAAXC,EAAU,EAAVA,OACvBC,EAAkBC,IAAMrO,SAQ5B,OANAqO,IAAMlR,WAAU,WACViR,EAAgBnO,SAAWkO,IAC7BC,EAAgBnO,QAAQqO,UAAYH,KAErC,CAACA,IAECA,EAIE,uBAAOpO,IAAKqO,EAAiB/R,MAAO,IAAKC,OAAQ,IAAKiS,UAAQ,IAH5D,KAMX,IAAIzM,GAAQ,EACR0M,GAAS,GAsMEC,OApMf,WACE,IAAQnO,EAAU8D,qBAAWC,GAArB/D,MAER,EAAkC3E,oBAAkB,GAApD,mBAAO+S,EAAP,KAAkBC,EAAlB,KACA,EAA8BhT,oBAAkB,GAAhD,mBAAO0C,EAAP,KAAgBuQ,EAAhB,KACA,EAAwBpK,cAAlBpC,EAAN,EAAMA,QAASC,EAAf,EAAeA,KAEf,EASIwM,KAAiB,CAEnBC,YAAa,CAEX/P,KAAM,yBAMNgQ,mBAAoB,KAGpBC,mBAAoB,KAEtBC,uBAAwB,CACtBnB,OAAO,EAEPoB,MAAO,CAAE7S,MAAO,KAAMC,OAAQ,SA1BhCN,EADF,EACEA,MACAkB,EAFF,EAEEA,OACAiS,EAHF,EAGEA,UACAC,EAJF,EAIEA,cACAC,EALF,EAKEA,eACAC,EANF,EAMEA,iBACAC,EAPF,EAOEA,eACAC,EARF,EAQEA,WAwIF,OAjHArS,qBAAU,WACR,IAAMsS,EAAMC,KAAKD,MAEjBjB,GAAOmB,KAAK,CACVjE,KAAM+D,EAAM3N,GAEZF,OAAQ,CACNI,QAAS1B,EAAML,QAAQ2B,OAAOI,QAC9BH,UAAW,CACTC,MAAOxB,EAAML,QAAQ2B,OAAOC,UAAUC,MACtCC,IAAKzB,EAAML,QAAQ2B,OAAOC,UAAUE,UAIzC,CACDzB,EAAML,QAAQ2B,OAAOI,QACrB1B,EAAML,QAAQ2B,OAAOC,UAAUC,MAC/BxB,EAAML,QAAQ2B,OAAOC,UAAUE,MA0CjC5E,qBAAU,WACR,GAAe,YAAXD,EAAsB,CACxB,IAAI0S,EAAS,IAAIC,WACjBD,EAAOE,cAAcX,GACrBS,EAAOG,UAAY,WACjB,IAAIC,EAAgBJ,EAAOK,OAAOC,WAC9BC,EAAaH,EAAcI,OAAOJ,EAAcK,QAAQ,KAAO,GAGnEnP,MAAM,+BAAD,OAAgCkB,EAAhC,YAA2CC,GAAQ,CACtDiO,OAAQ,OAERC,KAAMJ,IAELhP,MAAK,SAACC,GACLoP,QAAQ9T,IAAI,iBAGbyE,MAAK,SAAC9D,GACLmT,QAAQ9T,IAAI,cAAeW,UAKlC,CAACH,IA+BF,sBAAKQ,UAAU,QAAf,UACE,0CACA,4BAAI1B,EAAK,UAAMkB,EAAN,YAAgBlB,EAAMuB,SAAYL,IAC3C,sBAAKQ,UAAU,iBAAf,UACE,qBAAKA,UAAU,qBAAf,UACKW,GACD,wBAAQU,KAAK,SAAS4K,QAhBL,SAACqE,GAC1BY,GAAW,GACXS,KAcQ,sBAIA,wBAAQtQ,KAAK,SAAS4K,QAhBN,SAACqE,GACzBY,GAAW,GACXU,KAcQ,4BAKJ,sBAAK5R,UAAU,wBAAf,UACE,qBACErB,MAAM,KACNC,OAAO,IACPqB,QAAQ,WACRC,KAAK,OACLC,MAAM,6BALR,SAOE,sBACE4S,SAAS,UACTC,SAAS,UACTC,EAAE,6IACF/S,KAAK,QACLgT,YAAY,UAIhB,cAAC1C,GAAD,CAAmBC,OAAQqB,UAG/B,cAAC,GAAD,CAAQ3B,QAASsB,KAEdT,GACD,cAAC,GAAD,CAAQ/E,QAAS,SAACtM,GAAD,OAlErBkS,IACAZ,GAAa,GACb7M,GAAQ4N,KAAKD,WACbjB,GAAS,IAEFmB,KAAK,CACVjE,KAAM,EAEN9J,OAAQ,CACNI,QAAS1B,EAAML,QAAQ2B,OAAOI,QAC9BH,UAAW,CACTC,MAAOxB,EAAML,QAAQ2B,OAAOC,UAAUC,MACtCC,IAAKzB,EAAML,QAAQ2B,OAAOC,UAAUE,SAsDtC,qBACI,cAAC,GAAD,CAAQ4H,QAAS,SAACtM,GAAD,OApIzB+R,IACAT,GAAa,GAEbzN,MAAM,wBAAyB,CAC7BoP,OAAQ,OACRC,KAAMtS,KAAKC,UAAU,CACnBkE,UACAC,OACAL,QAAS/D,KAAKC,UAAUsQ,GAAQ,KAAM,OAGvCrN,MAAK,SAACC,GACLoP,QAAQ9T,IAAI,gBAGbyE,MAAK,SAAC9D,GACLmT,QAAQ9T,IAAI,aAAcW,WAI9BmR,GAAS,KAgHD,sBChPNqC,I,OAAU,IAAIC,KAAKC,eAAe,QAAS,CAC/CC,KAAM,UACNC,MAAO,UACPC,IAAK,UACLC,KAAM,UACNC,OAAQ,YAEPC,OAAO,IAAI3B,KAAsD,IAAjD4B,SAASjO,aAAkC,MAC3DkO,QAAQ,IAAK,KAMDC,OAJf,WACE,OAAO,sBAAK9T,UAAU,UAAf,qBAAkCmT,OCA5BY,I,OAtBF,WACX,IACW3N,EACPM,qBAAWG,GADbjE,MAASwD,KAGX,OACE,qBAAKpG,UAAU,OAAf,SACE,sBAAKA,UAAU,cAAf,UACE,oBAAIA,UAAU,cAAd,SAA6BoG,EAAK,iBAClC,mBAAGpG,UAAU,0BAAb,SACE,cAAC,EAAD,CAAUlB,KAAMsH,EAAK,kBAEvB,qBAAKpG,UAAU,YAAf,SACE,cAAC,IAAD,CAAMA,UAAU,YAAYgB,GAAIoF,EAAK,cAArC,SACE,6BAAKA,EAAK,0BCPP4N,GAZS,SAACC,GACnBA,GAAeA,aAAuBvU,UACxC,8BAAqB+D,MAAK,YAAkD,IAA/CyQ,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOD,GACPE,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAQL,OCadM,IAASxU,OACP,cAAC,IAAMyU,WAAP,UACE,cAAC,EAAD,UACE,cAAC,EAAD,UACE,cAAC,IAAD,UACE,sBAAKxU,UAAU,YAAf,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOyU,OAAK,EAACC,KAAK,IAAlB,SACE,cAAC,GAAD,MAEF,eAAC,IAAD,CAAOA,KAAK,kCAAZ,UACE,cAAC,GAAD,IAEC/O,gMAAYC,eACX,qCACE,cAAC+O,GAAD,IACA,cAAC,GAAD,aAMR,cAAC,GAAD,eAMVC,SAASC,eAAe,SAM1Bb,M,meCEMc,EAAY,GAGZC,EAAmB,IACnBC,EAAgB,IAChBC,EAAqB,IAGrBC,EAAgB,IAChBC,EAAmB,IAEnBC,EAAY,cAAeC,GAAU,OAAOrF,KAAKsF,UAAUC,UAC3DC,EACJ,cAAeH,GAAU,0BAA0BrF,KAAKsF,UAAUC,UAE9DvV,EAAY,0CAEZyV,EAAO,oFAIVzV,EAJU,6ZAiBRA,EAjBQ,6DAqBRA,EArBQ,0GA4BQkO,E,4MAQnBtL,MAAQ,CACN8S,SAAS,G,EAOXC,oBAAsB,WACpB,IAAMC,EAAQ,EAAKC,OAEnB,GAAKD,EAAL,CAGA,IAAQpU,EAAwCoU,EAAxCpU,MAAOkN,EAAiCkH,EAAjClH,eAAgBC,EAAiBiH,EAAjBjH,aAE/B,EAAKmH,cAAc,CACjBtU,QACAkN,iBACAC,mB,EAIJoH,UAAY,SAACjX,EAAcyL,GAAf,OACVzL,EAAKkX,UAAU,EAAGzL,GAAUmC,MAAM,O,EAEpCoJ,cAAgB,SAAChF,GAAiD,IAAjCmF,EAAgC,wDAC/D,EAA0B,EAAKC,SAAvBC,EAAR,EAAQA,MAAO1J,EAAf,EAAeA,OAEf,GAAI0J,EAAM9W,QAAUoN,GAAU,EAAG,CAE/B,EAAKyJ,SAASC,MAAQA,EAAMtJ,MAAM,EAAGJ,EAAS,GAG9C,IAAM2J,EAAQ,EAAKF,SAASC,MAAM9W,OAElC,GAAI+W,EAAQlB,EAAe,CACzB,IAAMmB,EAASD,EAAQlB,EAEvB,EAAKgB,SAASC,MAAQA,EAAMtJ,MAAMwJ,EAAQD,GAC1C,EAAKF,SAASzJ,OAASjF,KAAKH,IAAI,EAAK6O,SAASzJ,OAAS4J,EAAQ,IAInE,IAAMrK,EAAYgG,KAAKD,MAEvB,GAAIkE,EAAW,CACb,IAAMK,EAAO,EAAKJ,SAASC,MAAM,EAAKD,SAASzJ,QAE/C,GAAI6J,GAAQtK,EAAYsK,EAAKtK,UAAYmJ,EAAkB,CAIzD,IAAMoB,EAAK,yBAGLC,EAAW,EAAKT,UAAUO,EAAK9U,MAAO8U,EAAK5H,gBAC9C+H,MACA7G,MAAM2G,GAGHhU,EAAU,EAAKwT,UAAUjF,EAAOtP,MAAOsP,EAAOpC,gBACjD+H,MACA7G,MAAM2G,GAET,GAAIC,GAAYjU,GAAWA,EAAQ,GAAGmU,WAAWF,EAAS,IAKxD,YAFA,EAAKN,SAASC,MAAM,EAAKD,SAASzJ,QAAlC,2BAAiDqE,GAAjD,IAAyD9E,gBAQ/D,EAAKkK,SAASC,MAAMlE,KAApB,2BAA8BnB,GAA9B,IAAsC9E,eACtC,EAAKkK,SAASzJ,U,EAGhBkK,aAAe,SAAC7F,GACd,IAAM8E,EAAQ,EAAKC,OAEdD,IAGLA,EAAMpU,MAAQsP,EAAOtP,MACrBoU,EAAMlH,eAAiBoC,EAAOpC,eAC9BkH,EAAMjH,aAAemC,EAAOnC,aAE5B,EAAK/G,MAAMgH,cAAckC,EAAOtP,S,EAGlCoV,YAAc,SAAC9F,GAEb,IAAM8E,EAAQ,EAAKC,OACbS,EAAO,EAAKJ,SAASC,MAAM,EAAKD,SAASzJ,QAE3C6J,GAAQV,IACV,EAAKM,SAASC,MAAM,EAAKD,SAASzJ,QAAlC,2BACK6J,GADL,IAEE5H,eAAgBkH,EAAMlH,eACtBC,aAAciH,EAAMjH,gBAKxB,EAAKmH,cAAchF,GACnB,EAAK6F,aAAa7F,I,EAGpB+F,UAAY,WACV,MAA0B,EAAKX,SAAvBC,EAAR,EAAQA,MAAO1J,EAAf,EAAeA,OAGTqE,EAASqF,EAAM1J,EAAS,GAE1BqE,IAEF,EAAK6F,aAAa7F,GAClB,EAAKoF,SAASzJ,OAASjF,KAAKH,IAAIoF,EAAS,EAAG,K,EAIhDqK,UAAY,WACV,MAA0B,EAAKZ,SAAvBC,EAAR,EAAQA,MAAO1J,EAAf,EAAeA,OAGTqE,EAASqF,EAAM1J,EAAS,GAE1BqE,IAEF,EAAK6F,aAAa7F,GAClB,EAAKoF,SAASzJ,OAASjF,KAAKD,IAAIkF,EAAS,EAAG0J,EAAM9W,OAAS,K,EAI/D0X,eAAiB,SAACpX,GAChB,MAA2D,EAAKiI,MAAxDoP,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,aAAcC,EAA/B,EAA+BA,aAAcC,EAA7C,EAA6CA,UAE7C,IAAIA,IACFA,EAAUxX,IAENA,EAAEyX,kBAHR,CA3LmB,KAmMfzX,EAAE0X,SACJ1X,EAAEmC,OAAOwV,OAGX,MAAgD3X,EAAEmC,OAA1CN,EAAR,EAAQA,MAAOkN,EAAf,EAAeA,eAAgBC,EAA/B,EAA+BA,aAEzB4I,GAAgBN,EAAe,IAAM,MAAMO,OAAOR,GAExD,GApNgB,IAoNZrX,EAAE0X,UAA4BH,GAAgB,EAAKtU,MAAM8S,QAI3D,GAFA/V,EAAE8X,iBAEE9X,EAAE+X,SAAU,CAEd,IAAMC,EAAmB,EAAK5B,UAAUvU,EAAOkN,GACzCkJ,EAAYD,EAAiBtY,OAAS,EACtCwY,EAAU,EAAK9B,UAAUvU,EAAOmN,GAActP,OAAS,EACvDyY,EAAYtW,EACfkL,MAAM,MACNrM,KAAI,SAACsM,EAAMoL,GACV,OACEA,GAAKH,GACLG,GAAKF,GACLlL,EAAK+J,WAAWa,GAET5K,EAAKqJ,UAAUuB,EAAalY,QAG9BsN,KAERqL,KAAK,MAER,GAAIxW,IAAUsW,EAAW,CACvB,IAAMG,EAAgBN,EAAiBC,GAEvC,EAAKhB,YAAY,CACfpV,MAAOsW,EAGPpJ,eAAgBuJ,EAAcvB,WAAWa,GACrC7I,EAAiB6I,EAAalY,OAC9BqP,EAEJC,aAAcA,GAAgBnN,EAAMnC,OAASyY,EAAUzY,gBAGtD,GAAIqP,IAAmBC,EAAc,CAE1C,IAAMgJ,EAAmB,EAAK5B,UAAUvU,EAAOkN,GACzCkJ,EAAYD,EAAiBtY,OAAS,EACtCwY,EAAU,EAAK9B,UAAUvU,EAAOmN,GAActP,OAAS,EACvD4Y,EAAgBN,EAAiBC,GAEvC,EAAKhB,YAAY,CACfpV,MAAOA,EACJkL,MAAM,MACNrM,KAAI,SAACsM,EAAMoL,GACV,OAAIA,GAAKH,GAAaG,GAAKF,EAClBN,EAAe5K,EAGjBA,KAERqL,KAAK,MAGRtJ,eAAgB,KAAKsB,KAAKiI,GACtBvJ,EAAiB6I,EAAalY,OAC9BqP,EAEJC,aACEA,EAAe4I,EAAalY,QAAUwY,EAAUD,EAAY,SAE3D,CACL,IAAMM,EAAmBxJ,EAAiB6I,EAAalY,OAEvD,EAAKuX,YAAY,CAEfpV,MACEA,EAAMwU,UAAU,EAAGtH,GACnB6I,EACA/V,EAAMwU,UAAUrH,GAElBD,eAAgBwJ,EAChBvJ,aAAcuJ,SAGb,GAlSe,IAkSXvY,EAAE0X,QAA+B,CAC1C,IAAMc,EAAezJ,IAAmBC,EAGxC,GAFwBnN,EAAMwU,UAAU,EAAGtH,GAEvB0J,SAASb,KAAkBY,EAAc,CAE3DxY,EAAE8X,iBAEF,IAAMS,EAAmBxJ,EAAiB6I,EAAalY,OAEvD,EAAKuX,YAAY,CAEfpV,MACEA,EAAMwU,UAAU,EAAGtH,EAAiB6I,EAAalY,QACjDmC,EAAMwU,UAAUrH,GAElBD,eAAgBwJ,EAChBvJ,aAAcuJ,UAGb,GAxTW,KAwTPvY,EAAE0X,SAEX,GAAI3I,IAAmBC,EAAc,CAEnC,IACM0J,EADO,EAAKtC,UAAUvU,EAAOkN,GAAgB+H,MAC9B7G,MAAM,QAE3B,GAAIyI,GAAWA,EAAQ,GAAI,CACzB1Y,EAAE8X,iBAGF,IAAMa,EAAS,KAAOD,EAAQ,GACxBH,EAAmBxJ,EAAiB4J,EAAOjZ,OAEjD,EAAKuX,YAAY,CAEfpV,MACEA,EAAMwU,UAAU,EAAGtH,GACnB4J,EACA9W,EAAMwU,UAAUrH,GAElBD,eAAgBwJ,EAChBvJ,aAAcuJ,WAIf,GA5UY,KA6UjBvY,EAAE0X,SACF1X,EAAE0X,UAAYtC,GACdpV,EAAE0X,UAAYrC,GACdrV,EAAE0X,UAAYpC,EACd,CACA,IAAIsD,EAlVa,KAoVb5Y,EAAE0X,SAA8B1X,EAAE+X,SACpCa,EAAQ,CAAC,IAAK,KACL5Y,EAAE0X,UAAYtC,EAErBwD,EADE5Y,EAAE+X,SACI,CAAC,IAAK,KAEN,CAAC,IAAK,KAEP/X,EAAE0X,UAAYrC,EAErBuD,EADE5Y,EAAE+X,SACI,CAAC,IAAK,KAEN,CAAC,IAAK,KAEP/X,EAAE0X,UAAYpC,GAAuBtV,EAAE+X,WAChDa,EAAQ,CAAC,IAAK,MAIZ7J,IAAmBC,GAAgB4J,IACrC5Y,EAAE8X,iBAEF,EAAKb,YAAY,CACfpV,MACEA,EAAMwU,UAAU,EAAGtH,GACnB6J,EAAM,GACN/W,EAAMwU,UAAUtH,EAAgBC,GAChC4J,EAAM,GACN/W,EAAMwU,UAAUrH,GAElBD,iBACAC,aAAcA,EAAe,WAIhC6G,EAEG7V,EAAE6Y,SAAW7Y,EAAE0X,UAAYvC,EAE3BnV,EAAE8Y,SAAW9Y,EAAE0X,UAAYvC,IAC9BnV,EAAE+X,UACF/X,EAAE+Y,QAMFlD,EAEG7V,EAAE6Y,SAAW7Y,EAAE0X,UAAYvC,GAAanV,EAAE+X,SAC1CtC,EAEAzV,EAAE8Y,SA3YM,KA2YK9Y,EAAE0X,QAEf1X,EAAE8Y,SAAW9Y,EAAE0X,UAAYvC,GAAanV,EAAE+X,YAC7C/X,EAAE+Y,QAEH/Y,EAAE8X,iBAEF,EAAKX,aAhZO,KAkZZnX,EAAE0X,UACF1X,EAAE8Y,SACDjD,IAAY7V,EAAE+X,WAEf/X,EAAE8X,iBAGF,EAAKkB,UAAS,SAAC/V,GAAD,MAAY,CACxB8S,SAAU9S,EAAM8S,cA1BlB/V,EAAE8X,iBAEF,EAAKZ,e,EA6BT+B,cAAgB,SAACjZ,GACf,MAAgDA,EAAEmC,OAA1CN,EAAR,EAAQA,MAAOkN,EAAf,EAAeA,eAAgBC,EAA/B,EAA+BA,aAE/B,EAAKmH,cACH,CACEtU,QACAkN,iBACAC,iBAEF,GAGF,EAAK/G,MAAMgH,cAAcpN,I,EAG3B0U,SAAoB,CAClBC,MAAO,GACP1J,QAAS,G,uDAxXX,WACEoM,KAAKlD,wB,mBA4XP,WACE,MAAO,CACLmD,QAASD,KAAK3C,W,IAIlB,SAAY6C,GACVF,KAAK3C,SAAW6C,EAAQD,U,oBAG1B,WAAU,IAAD,OACP,EA8BID,KAAKjR,MA7BPpG,EADF,EACEA,MACAqG,EAFF,EAEEA,MACAmR,EAHF,EAGEA,QACA9L,EAJF,EAIEA,UACA+L,EALF,EAKEA,WACA5K,EANF,EAMEA,kBACA6K,EAPF,EAOEA,UACAC,EARF,EAQEA,SACAC,EATF,EASEA,KACAC,EAVF,EAUEA,UACAC,EAXF,EAWEA,UACA1Z,EAZF,EAYEA,KACA2Z,EAbF,EAaEA,YACAC,EAdF,EAcEA,SACAC,EAfF,EAeEA,SACAxN,EAhBF,EAgBEA,QACAqC,EAjBF,EAiBEA,QACAE,EAlBF,EAkBEA,OACAkL,EAnBF,EAmBEA,QAIAjL,GAvBF,EAqBE0I,UArBF,EAsBEvI,cAtBF,EAuBEH,UAKAL,GA5BF,EAwBE4I,QAxBF,EAyBEC,aAzBF,EA0BEC,aA1BF,EA4BE9I,cACGuL,EA7BL,iBAgCMC,EAAe,CACnBC,WAAYb,EACZc,aAAcd,EACde,cAAef,EACfgB,YAAahB,GAGTiB,EAAc/M,EAAU1L,GAE9B,OACE,gDAASmY,GAAT,IAAe9R,MAAK,2BAAOoF,EAAOiN,WAAcrS,GAAhD,UACE,0BACExF,IAAK,SAAC8X,GAAD,OAAQ,EAAKtE,OAASsE,GAC3BtS,MAAK,uCACAoF,EAAO/I,QACP+I,EAAOmN,UACPR,GAEL5Z,UACEA,GAAaqO,EAAiB,WAAOA,GAAsB,IAE7DtH,GAAIkS,EACJzX,MAAOA,EACP8F,SAAUuR,KAAKD,cACfnK,SAAUA,EACV0I,UAAW0B,KAAK9B,eAChB9K,QAASA,EACTyN,QAASA,EACTpL,QAASA,EACTE,OAAQA,EACR2K,SAAUA,EACVC,KAAMA,EACNC,UAAWA,EACXC,UAAWA,EACX1Z,KAAMA,EACN2Z,YAAaA,EACbC,SAAUA,EACVC,SAAUA,EACVP,UAAWA,EACXmB,eAAe,MACfC,aAAa,MACbC,YAAY,MACZC,YAAY,EACZC,cAAY,IAEd,iCACEza,UAAWoO,EACXb,cAAY,OACZ1F,MAAK,uCAAOoF,EAAO/I,QAAW+I,EAAOC,WAAc0M,IACvB,kBAAhBK,EACR,CAAE9M,wBAAyB,CAAEC,OAAQ6M,EAAc,WACnD,CAAEvZ,SAAUuZ,KAGlB,uBAAO5Y,KAAK,WAAW8L,wBAAyB,CAAEC,OAAQqI,a,GA1e9B9E,aAAfzC,EACZwM,aAAe,CACpB1D,QAAS,EACTC,cAAc,EACdC,cAAc,EACd8B,QAAS,GA2eN,IAAM/L,EAAS,CACpBiN,UAAW,CACT3P,SAAU,WACVoQ,UAAW,OACXC,UAAW,aACX5B,QAAS,EACT6B,SAAU,UAEZT,SAAU,CACR7P,SAAU,WACVuQ,IAAK,EACLC,KAAM,EACNnc,OAAQ,OACRD,MAAO,OACPqc,OAAQ,OACRC,MAAO,UACPJ,SAAU,SACVK,oBAAqB,YACrBC,oBAAqB,cACrBC,oBAAqB,eAEvBlO,UAAW,CACT3C,SAAU,WACV8Q,cAAe,QAEjBnX,OAAQ,CACNoX,OAAQ,EACRC,OAAQ,EACRC,WAAY,OACZZ,UAAW,UACXa,QAAS,UACTC,WAAY,UACZC,SAAU,UACVC,UAAW,UACXC,qBAAsB,UACtBC,WAAY,UACZC,cAAe,UACfC,WAAY,UACZhF,QAAS,UACTiF,WAAY,UACZC,cAAe,UACfC,cAAe,UACfC,WAAY,WACZC,UAAW,WACXC,aAAc,iB","file":"static/js/main.ac89a380.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./styles.css\";\n\ntype PreviewProps = {\n  code: string;\n  check?: string;\n  hideErrors?: boolean;\n  themeNetative?: boolean;\n  solved?: Function;\n};\n\ntype Box = {\n  x?: number;\n  y?: number;\n  width?: number;\n  height?: number;\n};\n\ntype Text = string;\n\nlet boxList: Box[] = [];\nlet textList: Text[] = [];\nlet renderError = \"\";\n\nfunction Preview({\n  code,\n  check,\n  hideErrors,\n  themeNetative,\n  solved,\n}: PreviewProps) {\n  const [boxes, setBoxes] = useState<Box[]>([]);\n  const [texts, setTexts] = useState<Text[]>([]);\n  const [error, setError] = useState(\"\");\n\n  function Box(x = 0, y = 0, width = 100, height = 100) {\n    boxList = [\n      ...boxList,\n      {\n        x: x,\n        y: y,\n        width,\n        height,\n      },\n    ];\n  }\n\n  function print(text = \"\") {\n    textList = [...textList, text];\n  }\n\n  const conzole = {\n    log: (text = \"\") => {\n      textList = [...textList, text];\n    },\n  };\n\n  function hasBox(x?: number, y?: number, width?: number, height?: number) {\n    return boxList.filter((item) => {\n      let found = true;\n\n      if (x) {\n        found = item.x === x;\n      }\n      if (y) {\n        found = item.y === y;\n      }\n\n      if (width) {\n        found = item.width === width;\n      }\n\n      if (height) {\n        found = item.height === height;\n      }\n\n      return found;\n    }).length;\n  }\n\n  function hasText(filter: (value: Text, index: number, array: Text[]) => any) {\n    return textList.filter(filter).length;\n  }\n\n  function complete(status: boolean) {\n    if (solved) {\n      solved(status);\n    }\n  }\n\n  const render = (code: string, check: string | undefined) => {\n    if (!code) {\n      return;\n    }\n    function runCodeWithDateFunction(code: string) {\n      // return Function('\"use strict\";return (' + code + \")\")()(Box);\n\n      try {\n        return Function(\"return (\\n\" + code + \"\\n)\")()(\n          Box,\n          print,\n          hasBox,\n          hasText,\n          complete,\n          conzole\n        );\n      } catch (e) {\n        complete(false);\n        renderError = e.name + \": \" + e.message;\n        // console.warn(renderError);\n      }\n    }\n\n    runCodeWithDateFunction(\n      `function(Box, print, hasBox, hasText, complete, console){ \\n${code}\\n${\n        check ? check : \"\"\n      }\\n }`\n    );\n  };\n\n  useEffect(() => {\n    boxList = [];\n    textList = [];\n    renderError = \"\";\n    render(code, check);\n    setBoxes(boxList);\n    setTexts(textList);\n    setError(renderError);\n  }, [code, check]);\n\n  return (\n    <div className={themeNetative ? \"preview preview--negative\" : \"preview\"}>\n      <div className=\"preview__view\">\n        <svg\n          width=\"215\"\n          height=\"302\"\n          viewBox=\"-2.5 -2.5 215 302\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <rect className=\"svg__rect svg__paper\" width=\"210\" height=\"297\" />\n\n          <text className=\"svg__text code\" textAnchor=\"end\" x=\"205\" y=\"18\">\n            A4\n          </text>\n\n          {boxes.map((item, index) => (\n            <rect\n              key={index}\n              className=\"svg__rect\"\n              x={item.x}\n              y={item.y}\n              width={item.width}\n              height={item.height}\n            />\n          ))}\n        </svg>\n        {/* \n        <pre>\n          <code>{JSON.stringify(boxes, null, 2)}</code>\n        </pre>\n         */}\n      </div>\n      {texts.length > 0 && (\n        <div className=\"preview__console code\">\n          <pre>\n            {texts.map((text, index) => (\n              <code key={index}>\n                {JSON.stringify(text)}\n                {\"\\n\"}\n              </code>\n            ))}\n          </pre>\n        </div>\n      )}\n      {error && !hideErrors && (\n        <div className=\"preview__error\">\n          <p>⚠️ Der Code hat im Moment noch Fehler.</p>\n          <div className=\"preview__debug\">\n            <code>{error}</code>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Preview;\n","\nimport \"./styles.css\";\nimport Preview from \"../Preview\";\n\ntype WorkSpaceProps = {\n  preview: string;\n  check?: string;\n  // filename: string;\n  children: React.ReactNode;\n  hideErrors?: boolean;\n  focus?: boolean;\n  solved: Function;\n};\n\nfunction WorkSpace({\n  children,\n  preview,\n  check,\n  hideErrors,\n  focus,\n  solved,\n}: WorkSpaceProps) {\n  return (\n    <div className={`work-space work-space--${focus ? \"focus\" : \"blur\"}`}>\n      <div className=\"work-space__file\">{children}</div>\n      <div className=\"work-space__canvas\">\n        <Preview\n          code={preview}\n          check={check}\n          hideErrors={hideErrors}\n          themeNetative={true}\n          solved={solved}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default WorkSpace;\n","import React, { ReactNode } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport \"./styles.css\";\n\ntype CalloutProps = {\n  children: ReactNode;\n  done: boolean;\n  next: string;\n};\n\nfunction Callout({ children, done, next }: CalloutProps) {\n  return (\n    <div className={`callout callout--${done ? \"done\" : \"open\"}`}>\n      {children}\n\n      {done === true && (\n        <Link to={next}>\n          <div className=\"callout__next\">\n            <div className=\"callout__next-icon icon icon-right\"></div>\n            <h3 className=\"callout__next-text\">Nächste Aufgabe</h3>\n          </div>\n        </Link>\n      )}\n    </div>\n  );\n}\n\nexport default Callout;\n","\nimport \"./styles.css\";\n\nfunction StatusIcon() {\n  return (\n    <span className={`status-icon status-icon--ok`}>\n      <span className={`icon icon-ok`} />\n    </span>\n  );\n}\n\nexport default StatusIcon;\n","import fromMarkdown, { mdToken, mdTypes } from \"mdast-util-from-span-markdown\";\nimport React from \"react\";\nimport \"./styles.css\";\n\nexport type markdownProps = {\n  text: string;\n};\n\nconst obj2jsx = (token: mdToken, key: number) => {\n  switch (token.type) {\n    case mdTypes.INLINE_CODE:\n      return <code key={key}>{token.value}</code>;\n    case mdTypes.EMPHASIS:\n    case mdTypes.STRONG:\n      return (\n        <em key={key}>\n          {token.children.map((item, index) => obj2jsx(item, index))}\n        </em>\n      );\n    case mdTypes.LINK:\n      return (\n        <a key={key} href={token.url} target=\"_blank\" rel=\"noreferrer\">\n          {token?.children.map((item, index) => obj2jsx(item, index))}\n        </a>\n      );\n    case mdTypes.TEXT:\n      return (\n        <span className=\"markdown__text\" key={key}>\n          {token.value}\n        </span>\n      );\n    default:\n      return <span>⚠️ no handling</span>;\n  }\n};\n\nconst Markdown = ({ text }: markdownProps) => {\n  const tokens = fromMarkdown(text);\n  return (\n    <span className=\"markdown\">\n      {tokens && tokens.map((token, index) => obj2jsx(token, index))}\n    </span>\n  );\n};\nexport default Markdown;\n","import { useRef, useEffect } from \"react\";\n\nexport default function usePrevious(value: any) {\n  const ref = useRef();\n\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n\n  return ref.current;\n}\n","// https://usehooks-typescript.com/react-hook/use-fetch\n\nimport React, {\n  useState,\n  useEffect,\n  useReducer,\n  useCallback,\n  Reducer,\n  useRef,\n} from \"react\";\n\nimport usePrevious from \"./usePrevious\";\n\ninterface InitialState<T = any> {\n  data: T;\n  isLoading: boolean;\n  error: unknown;\n}\n\ntype ActionTypes<T> =\n  | { type: \"FETCH_START\" }\n  | { type: \"FETCH_SUCCESS\"; payload: InitialState<T>[\"data\"] }\n  | { type: \"FETCH_ERROR\"; payload: InitialState<T>[\"error\"] };\n\nconst initialState: InitialState = {\n  data: null,\n  isLoading: false,\n  error: null,\n};\n\ntype FetchReducer<T = any> = Reducer<InitialState<T>, ActionTypes<T>>;\n\nconst fetchReducer: FetchReducer = (state, action) => {\n  switch (action.type) {\n    case \"FETCH_START\": {\n      return { data: null, isLoading: true, error: null };\n    }\n    case \"FETCH_SUCCESS\": {\n      return { data: action.payload, isLoading: false, error: null };\n    }\n\n    case \"FETCH_ERROR\": {\n      return { data: null, isLoading: false, error: action.payload };\n    }\n    default:\n      return state;\n  }\n};\n\nfunction useFetch<T = unknown>(url: string, options?: object) {\n  const previousUrl = usePrevious(url);\n\n  const [state, dispatch] = useReducer<FetchReducer<T>>(\n    fetchReducer,\n    initialState\n  );\n\n  const getFetchResult = useCallback(async () => {\n    dispatch({ type: \"FETCH_START\" });\n\n    fetch(url, options)\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        } else {\n          throw new Error(response.statusText);\n        }\n      })\n      .then((data: T) => {\n        dispatch({ type: \"FETCH_SUCCESS\", payload: (data as unknown) as T });\n      })\n      .catch(() => {\n        dispatch({ type: \"FETCH_ERROR\", payload: true });\n      });\n  }, [url]);\n\n  useEffect(() => {\n    getFetchResult();\n  }, [url]);\n\n  // let's not wait for the lifecycle\n  if (previousUrl !== url) {\n    return { response: null, loading: true, hasError: false };\n  }\n\n  return {\n    response: state.data,\n    loading: state.isLoading,\n    hasError: state.error,\n  };\n}\n\nexport default useFetch;\n","import React, {\n  Reducer,\n  createContext,\n  useReducer,\n  Dispatch,\n  useEffect,\n} from \"react\";\nimport { ActionMap } from \"./ActionMap\";\nimport { set } from \"lodash\";\n\nenum Action {\n  SET_PROGRESS = \"SET_PROGRESS\",\n  SET_CURRENT_STEP_PROGRESS = \"SET_CURRENT_STEP_PROGRESS\",\n  SET_CURRENT_CHAPTER_PROGRESS = \"SET_CURRENT_CHAPTER_PROGRESS\",\n  SET_EDITOR_CONTENT = \"SET_EDITOR_CONTENT\",\n  SET_EDITOR_SELECTION = \"SET_EDITOR_SELECTION\",\n  SET_EDITOR_FOCUS = \"SET_EDITOR_FOCUS\",\n}\n\nexport type Selection = {\n  start: number;\n  end: number;\n};\n\ntype ActionPayload = {\n  [Action.SET_CURRENT_STEP_PROGRESS]: {\n    chapter: string;\n    step: string;\n    value: boolean;\n  };\n  [Action.SET_CURRENT_CHAPTER_PROGRESS]: {\n    chapter: string;\n    value: boolean;\n  };\n  [Action.SET_PROGRESS]: {\n    progress: {\n      [key: string]: ChapterProgress;\n    };\n  };\n  [Action.SET_EDITOR_CONTENT]: {\n    chapter: string;\n    step: string;\n    value: string;\n  };\n  [Action.SET_EDITOR_SELECTION]: {\n    value: Selection;\n  };\n  [Action.SET_EDITOR_FOCUS]: {\n    value: boolean;\n  };\n};\n\nexport type Actions = ActionMap<ActionPayload>[keyof ActionMap<ActionPayload>];\n\n// type Task = {\n//   instruction: string;\n//   match: string;\n// };\n\ntype ChapterProgress = {\n  done: boolean;\n  steps: {\n    [key: string]: StepProgress;\n  };\n};\n\ntype StepProgress = {\n  done?: boolean;\n  editor?: Editor;\n};\n\nexport type EditorFrame = {\n  time: number;\n  editor: EditorState;\n};\n\nexport type Editor = {\n  content: string;\n};\n\nexport type EditorState = {\n  selection: Selection;\n  content: string;\n  focus: boolean;\n};\n\ntype Current = {\n  editor: EditorState;\n};\n\ntype State = {\n  current: Current;\n  progress?: {\n    [key: string]: ChapterProgress;\n  };\n};\n\nconst initialState: State = {\n  current: {\n    editor: {\n      selection: { start: 0, end: 0 },\n      content: \"\",\n      focus: false,\n    },\n  },\n  progress: {\n    // intro: { done: false, steps: [] },\n    // comments: { done: false, steps: [] },\n    // variables: { done: false, steps: [] },\n    // types: { done: false, steps: [] },\n    // operators: { done: false, steps: [] },\n    // functions: { done: false, steps: [] },\n    // itterations: { done: false, steps: [] },\n    // conditions: { done: false, steps: [] },\n    // \"advanced-types\": { done: false, steps: [] },\n    // intro: {\n    //   done: true,\n    //   steps: { overview: { done: true }, function: { done: true } },\n    // },\n    // comments: { done: true, steps: {} },\n    // variables: { done: true, steps: {} },\n    // types: { done: true, steps: {} },\n    // operators: { done: true, steps: {} },\n    // functions: { done: false, steps: { overview: { done: true } } },\n    // itterations: { done: false, steps: {} },\n    // conditions: { done: false, steps: {} },\n    // \"advanced-types\": { done: false, steps: {} },\n  },\n};\n\nconst reducer: Reducer<State, Actions> = (state, action) => {\n  switch (action.type) {\n    case Action.SET_CURRENT_STEP_PROGRESS:\n      return (() => {\n        const { chapter, step, value } = action.payload;\n        const newPorgress = set(\n          { ...state.progress } || {},\n          [chapter, \"steps\", step, \"done\"],\n          value\n        );\n\n        return {\n          ...state,\n          progress: {\n            ...newPorgress,\n          },\n        };\n      })();\n    case Action.SET_CURRENT_CHAPTER_PROGRESS:\n      return (() => {\n        const { chapter, value } = action.payload;\n        const newPorgress = set(\n          { ...state.progress } || {},\n          [chapter, \"done\"],\n          value\n        );\n\n        return {\n          ...state,\n          progress: {\n            ...newPorgress,\n          },\n        };\n      })();\n\n    case Action.SET_PROGRESS:\n      return (() => {\n        const { progress } = action.payload;\n\n        return {\n          ...state,\n          progress: {\n            ...state.progress,\n            ...progress,\n          },\n        };\n      })();\n\n    case Action.SET_EDITOR_CONTENT:\n      return (() => {\n        const { chapter, step, value } = action.payload;\n        const newPorgress = set(\n          { ...state.progress } || {},\n          [chapter, \"steps\", step, \"editor\", \"content\"],\n          value\n        );\n\n        return {\n          ...state,\n          current: {\n            ...state.current,\n            editor: {\n              ...state.current.editor,\n              content: value,\n            },\n          },\n          progress: {\n            ...newPorgress,\n          },\n        };\n      })();\n\n    case Action.SET_EDITOR_SELECTION:\n      return (() => {\n        const { value } = action.payload;\n\n        return {\n          ...state,\n\n          current: {\n            ...state.current,\n            editor: {\n              ...state.current.editor,\n              selection: value,\n            },\n          },\n        };\n      })();\n\n    case Action.SET_EDITOR_FOCUS:\n      return (() => {\n        const { value } = action.payload;\n\n        return {\n          ...state,\n          current: {\n            ...state.current,\n            editor: {\n              ...state.current.editor,\n              focus: value,\n            },\n          },\n        };\n      })();\n\n    // default:\n    //   throw new Error(`Unhandled action type: ${action && action.type}`);\n  }\n};\n\nconst Context = createContext<{\n  state: State;\n  dispatch: Dispatch<Actions>;\n}>({\n  state: initialState,\n  dispatch: () => null,\n});\n\nconst Provider: React.FC = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  // Local Storage: setting & getting data\n  useEffect(() => {\n    if (localStorage) {\n      const progress = localStorage.getItem(\"session.progress\");\n\n      if (progress) {\n        dispatch({\n          type: Action.SET_PROGRESS,\n          payload: {\n            progress: JSON.parse(progress),\n          },\n        });\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    localStorage.setItem(\"session.progress\", JSON.stringify(state.progress));\n  }, [state.progress]);\n\n  return (\n    <Context.Provider value={{ state, dispatch }}>{children}</Context.Provider>\n  );\n};\n\nexport { Provider, Context, Action };\n","import React, {\n  Reducer,\n  createContext,\n  useReducer,\n  Dispatch,\n  useEffect,\n} from \"react\";\nimport { ActionMap } from \"./ActionMap\";\nimport { URL } from \"../util/api\";\n\nenum Action {\n  ADD_LANG = \"ADD_LANG\",\n  SET_CHAPTERS = \"SET_CHAPTERS\",\n}\n\ntype ActionPayload = {\n  [Action.ADD_LANG]: {\n    lang: {\n      [key: string]: string;\n    };\n  };\n  [Action.SET_CHAPTERS]: {\n    chapters: Chapter[];\n  };\n};\n\nexport type Actions = ActionMap<ActionPayload>[keyof ActionMap<ActionPayload>];\n\nexport type Chapter = {\n  id: string;\n  title: string;\n};\n\nexport type Step = {\n  id: string;\n  title: string;\n  task: Task;\n};\n\ntype Task = {\n  instruction: string;\n  match?: string;\n  check?: string;\n};\n\ntype State = {\n  chapters: Chapter[];\n  lang: {\n    [key: string]: string;\n  };\n};\n\nconst initialState: State = {\n  chapters: [],\n  lang: {},\n};\n\nconst reducer: Reducer<State, Actions> = (state, action) => {\n  switch (action.type) {\n    case Action.ADD_LANG:\n      return (() => {\n        const { lang } = action.payload;\n\n        return {\n          ...state,\n          lang: {\n            ...state.lang,\n            ...lang,\n          },\n        };\n      })();\n    case Action.SET_CHAPTERS:\n      return (() => {\n        const { chapters } = action.payload;\n\n        return {\n          ...state,\n          chapters,\n        };\n      })();\n\n    // default:\n    //   throw new Error(`Unhandled action type: ${action && action.type}`);\n  }\n};\n\nconst Context = createContext<{\n  state: State;\n  dispatch: Dispatch<Actions>;\n}>({\n  state: initialState,\n  dispatch: () => null,\n});\n\nconst Provider: React.FC = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  useEffect(() => {\n    // setLoading(true);\n\n    fetch(URL.course)\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        } else {\n          throw new Error(response.statusText);\n        }\n      })\n      .then((data: State) => {\n        if (data) {\n          dispatch({\n            type: Action.SET_CHAPTERS,\n            payload: {\n              chapters: data.chapters,\n            },\n          });\n          dispatch({\n            type: Action.ADD_LANG,\n            payload: {\n              lang: data.lang,\n            },\n          });\n        }\n      });\n    //   .catch(() => {\n    //     setResponse(null);\n    //     setHasError(true);\n    //     setLoading(false);\n    //   });\n  }, [URL.course]);\n\n  return (\n    <Context.Provider value={{ state, dispatch }}>{children}</Context.Provider>\n  );\n};\n\nexport { Provider, Context, Action };\n","import pkg from \"../../package.json\";\n\nconst base = process.env.REACT_APP_DEV\n  ? `${pkg.homepage}`\n  : `${process.env.PUBLIC_URL}`;\n\nexport const URL = {\n  course: `${base}/api/course/js/basic/course.json`,\n  chapter: ({ chapter }) =>\n    `${base}/api/course/js/basic/chapter/${chapter}.json`,\n  step: ({ chapter, step }) =>\n    `${base}/api/course/js/basic/chapter/${chapter}/${step}.json`,\n  movie: ({ chapter, step }) =>\n    `https://www.escep.ch/videos/convert/course/js/basic/chapter/${chapter}/${step}/playlist.m3u8`,\n};\n\nexport const ROUTE = {\n  chapterFirstStep: ({ chapter }) => `/course/js/basic/${chapter}/overview`,\n  step: ({ chapter, step }) => `/course/js/basic/${chapter}/${step}`,\n};\n","/*\n\ncheck \nhttps://github.com/daenub/IAD2019.news/blob/master/components/header/index.js\n\n*/\n\nimport React, { useContext } from \"react\";\nimport \"./styles.css\";\nimport {\n  Context as SessionContext,\n} from \"../../context/session\";\n\nimport { Context as CourseContext } from \"../../context/course\";\n\nimport { Chapter } from \"../../context/course\";\nimport StatusIcon from \"../StatusIcon\";\nimport { useParams } from \"react-router-dom\";\nimport { RouterParams } from \"../../index\";\nimport { Link } from \"react-router-dom\";\n\ntype CapterMenuItemProps = {\n  children: React.ReactNode;\n  done: boolean;\n  active: boolean;\n};\n\nfunction CapterMenuItem({ children, done, active }: CapterMenuItemProps) {\n  return (\n    <div\n      className={`capter-menu__item ${\n        active ? \"capter-menu__item--active\" : \"capter-menu__item--inactive\"\n      } ${\n        done && !active ? \"capter-menu__item--done\" : \"capter-menu__item--open\"\n      }`}\n    >\n      {children}\n    </div>\n  );\n}\n\nfunction CapterMenu() {\n  const { state } = useContext(SessionContext);\n  const { state: appState } = useContext(CourseContext);\n  let { chapter } = useParams<RouterParams>();\n\n  return (\n    <div className=\"capter-menu\">\n      {\n        <div className=\"capter-menu__list\">\n          {appState.chapters &&\n            appState.chapters.map((item: Chapter) => (\n              <CapterMenuItem\n                key={item.id}\n                done={(state.progress && state.progress[chapter]?.done) || false}\n                active={chapter === item.id}\n              >\n                <Link to={`/course/js/basic/${item.id}/overview`}>\n                  {state.progress && state.progress[item.id]?.done && (\n                    <StatusIcon />\n                  )}\n                  {item.title}\n                </Link>\n              </CapterMenuItem>\n            ))}\n        </div>\n      }\n    </div>\n  );\n}\n\nexport default CapterMenu;\n","import React, { useContext } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport \"./styles.css\";\nimport { RouterParams } from \"../../index\";\nimport { Context as SessionContext } from \"../../context/session\";\nimport { Step } from \"../../context/course\";\n\nimport { ROUTE } from \"../../util/api\";\nimport StatusIcon from \"../StatusIcon\";\nimport { Link } from \"react-router-dom\";\n\ntype StepMenuProps = {\n  steps: Step[];\n};\n\ntype StepMenuItemProps = {\n  children: React.ReactNode;\n  done: boolean;\n  active: boolean;\n};\n\nfunction StepMenuItem({ children, done, active }: StepMenuItemProps) {\n  return (\n    <div\n      className={`step-menu__item ${\n        active ? \"step-menu__item--active\" : \"step-menu__item--inactive\"\n      } ${done && !active ? \"step-menu__item--done\" : \"step-menu__item--open\"}`}\n    >\n      {children}\n    </div>\n  );\n}\n\nfunction StepMenu({ steps }: StepMenuProps) {\n  const { state } = useContext(SessionContext);\n  let { step, chapter } = useParams<RouterParams>();\n\n  // const chapter = state.chapters.find(\n  //   (item) => item.id === state.current.chapter\n  // );\n\n  return (\n    <div className=\"step-menu\">\n      <div className=\"step-menu__list\">\n        {steps.map((item) => (\n          <StepMenuItem\n            key={item.id}\n            done={\n              (state.progress &&\n                state.progress[chapter]?.steps[item.id] &&\n                state.progress[chapter]?.steps[item.id].done) ||\n              false\n            }\n            active={step === item.id}\n          >\n            <Link\n              className=\"step-menu__link\"\n              to={ROUTE.step({ chapter, step: item.id })}\n            >\n              {state.progress &&\n                state.progress[chapter]?.steps[item.id] &&\n                state.progress[chapter]?.steps[item.id].done && <StatusIcon />}\n              {item.title}\n            </Link>\n          </StepMenuItem>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default StepMenu;\n","\nimport { Range } from \"react-range\";\nimport \"./styles.css\";\n\ntype TrackProps = {\n  max: number;\n  value: number;\n  // max?: number;\n  // formatFn?: Function;\n  onChange: Function;\n};\n\nconst Track = ({ max, value, onChange }: TrackProps) => {\n  // const [value, setValue] = useState(0);\n\n  return (\n    <div className=\"track\">\n      <Range\n        step={0.1}\n        min={0.0}\n        max={Math.round(max * 10) / 10}\n        values={[value]}\n        onChange={(values) => onChange(values[0])}\n        renderTrack={({ props, children }) => (\n          <div {...props} className=\"track__range\">\n            <div\n              className=\"track__played\"\n              style={{\n                width: `${(100 / max) * value}%`,\n              }}\n            />\n            {children}\n          </div>\n        )}\n        renderThumb={({ props }) => <div {...props} className=\"track__thumb\" />}\n      />\n    </div>\n  );\n};\n\nexport default Track;\n","import React, { useEffect, useRef, useState } from \"react\";\nimport videojs, { VideoJsPlayer } from \"video.js\";\nimport \"video.js/dist/video-js.css\";\n// import LineControl from \"../LineControl\";\nimport Track from \"../Track\";\nimport \"./styles.css\";\nimport { useVideojs } from \"./useVideojs\";\n\n\n\ntype VideoPlayerProps = {\n  onTimeUpdate: Function;\n  src: string;\n};\n\nfunction VideoPlayer({ onTimeUpdate: update, src }: VideoPlayerProps) {\n  const [isPlaying, setPlaying] = useState(false);\n  const [isMuted, setMute] = useState(false);\n  const [duration, setDuration] = useState(0);\n  const [durationFormat, setDurationFormat] = useState(\"\");\n  const [playPosition, setPlayPosition] = useState(0);\n  const [isInitial, setInitial] = useState(true);\n\n  let player = useRef<VideoJsPlayer | null>(null);\n\n  const updatePosition = (pos: number | undefined) => {\n    update(pos || 0);\n    setPlayPosition(pos || 0);\n    // dispatch({\n    //   type: SessionAction.SET_PLAYER_POSITION,\n    //   payload: {\n    //     value: pos || 0,\n    //   },\n    // });\n  };\n\n  useEffect(() => {\n    updatePosition(0);\n    setDuration(0);\n    setMute(false);\n    setPlaying(false);\n    setInitial(true);\n  }, [src]);\n\n  const onPlay = (currentTime?: number) => {\n    updatePosition(currentTime);\n  };\n\n  const onPause = (currentTime?: number) => {\n    updatePosition(currentTime);\n  };\n\n  const onEnd = (currentTime?: number) => {\n    setPlaying(false);\n    updatePosition(currentTime);\n  };\n\n  const onTimeUpdate = (currentTime: number) => {\n    setPlayPosition(currentTime);\n    updatePosition(currentTime);\n  };\n  const onLoadedmetadata = (totalTime: number) => {\n    // updatePosition(currentTime);\n    setDuration(totalTime);\n  };\n\n  const onReady = (p: VideoJsPlayer) => {\n    player.current = p;\n  };\n\n  const { videoNodeRef } = useVideojs({\n    src,\n    controls: false,\n    autoplay: false,\n    responsive: false,\n    bigPlayButtonCentered: false,\n    width: 200,\n    height: 200,\n    html5: {\n      hls: {\n        overrideNative: true,\n      },\n      nativeAudioTracks: false,\n      nativeVideoTracks: false,\n    },\n    onPlay,\n    onPause,\n    onEnd,\n    onReady,\n    onTimeUpdate,\n    onLoadedmetadata,\n  });\n\n  const togglePlayback = () => {\n    // this.player.muted(this.mute);\n\n    if (player.current) {\n      setPlaying(!isPlaying);\n\n      if (!isPlaying) {\n        player.current.play();\n      } else {\n        player.current.pause();\n      }\n    }\n  };\n\n  const startPlayback = () => {\n    if (player.current) {\n      setInitial(false);\n      togglePlayback();\n    }\n  };\n\n  const toggleMute = () => {\n    // this.player.muted(this.mute);\n\n    if (player.current) {\n      setMute(!isMuted);\n\n      if (!isMuted) {\n        player.current.muted(true);\n      } else {\n        player.current.muted(false);\n      }\n    }\n  };\n\n  const setPosition = (timestamp: number) => {\n    // this.player.muted(this.mute);\n\n    if (player.current) {\n      player.current.currentTime(timestamp);\n    }\n  };\n\n  const playPositionFormat = videojs.formatTime(\n    Math.min(playPosition, duration),\n    600\n  );\n\n  useEffect(() => {\n    setDurationFormat(videojs.formatTime(duration, 600));\n  }, [duration]);\n\n  // wrap the player in a div with a `data-vjs-player` attribute\n  // so videojs won't create additional wrapper in the DOM\n  // see https://github.com/videojs/video.js/pull/3856\n  return (\n    <>\n      <div className=\"video-player\">\n        <div className=\"video-player__video\">\n          <div data-vjs-player>\n            <video ref={videoNodeRef}></video>\n          </div>\n        </div>\n        <div className=\"video-player__bar\">\n          <div className=\"video-player__track\">\n            {!!duration && (\n              <Track\n                max={duration}\n                value={playPosition}\n                onChange={(t: number) => setPosition(t)}\n              />\n            )}\n          </div>\n          <div className=\"video-player__control\">\n            {!!duration && (\n              <>\n                <button\n                  className={`video-player__btn ${\n                    isPlaying ? \"icon-pause\" : \"icon-play\"\n                  }`}\n                  onClick={togglePlayback}\n                ></button>\n                <button\n                  className={`video-player__btn ${\n                    isMuted ? \"icon-volume-off\" : \"icon-volume-up\"\n                  }`}\n                  onClick={toggleMute}\n                ></button>\n              </>\n            )}\n            <div className=\"video-player__time\">\n              {playPositionFormat} | {durationFormat}\n            </div>\n          </div>\n        </div>\n        {!!duration && isInitial && (\n          <div className=\"video-player__big-start\">\n            <button onClick={startPlayback}>\n              <span className=\"icon-play\"></span>\n            </button>\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n\nexport default VideoPlayer;\n","import \"./styles.css\";\nimport { styles } from \"../Editor/editor\";\n\nimport { highlight, languages } from \"prismjs/components/prism-core\";\nimport \"prismjs/components/prism-clike\";\nimport \"prismjs/components/prism-javascript\";\nimport \"prismjs/themes/prism.css\"; //Example style, you can use another\n\nimport { EditorState } from \"../../context/session\";\n\ntype TextPlayerProps = {\n  editor: EditorState | undefined;\n};\n\nenum PartType {\n  TEXT = \"TEXT\",\n  MARK = \"MARK\",\n  TEXT_SELECTED = \"TEXT_SELECTED\",\n}\n\ntype Part = {\n  type: PartType;\n  value: string;\n};\n\ntype Line = Part[];\n\nconst showPart = (part: Part) => {\n  switch (part.type) {\n    case PartType.TEXT:\n      return <span className=\"part part--text\">{part.value}</span>;\n    case PartType.MARK:\n      return <span className=\"part part--mark\">&#x200B;</span>;\n    case PartType.TEXT_SELECTED:\n      return <span className=\"part part--selected\">{part.value}</span>;\n    default:\n  }\n};\n\n// const splitAt = index => x => [x.slice(0, index), x.slice(index)]\n\nconst showLines = (code: string, start: number, end: number) => {\n  const hasCursor = start === end;\n  let offset = 0;\n  const lines: Line[] = code.split(\"\\n\").map((line: string) => {\n    let parts = null;\n\n    // there is just a cursor\n    if (hasCursor) {\n      // the cursor is in this line\n      if (start >= offset && end <= offset + line.length) {\n        parts = [\n          {\n            type: PartType.TEXT,\n            value: line.slice(0, start - offset),\n          },\n          {\n            type: PartType.MARK,\n            value: \"\",\n          },\n          {\n            type: PartType.TEXT,\n            value: line.slice(end - offset),\n          },\n        ];\n      }\n      // no cursor in this line\n      else {\n        parts = [\n          {\n            type: PartType.TEXT,\n            value: line,\n          },\n        ];\n      }\n    }\n    // there is a selection\n    else {\n      // selection start of line\n      if (start <= offset && end > offset) {\n        parts = [\n          {\n            type: PartType.TEXT_SELECTED,\n            value: line.slice(0, end - offset),\n          },\n          {\n            type: PartType.TEXT,\n            value: line.slice(end - offset),\n          },\n        ];\n      }\n      // selection in line\n      else if (start >= offset && start < offset + line.length) {\n        parts = [\n          {\n            type: PartType.TEXT,\n            value: line.slice(0, start - offset),\n          },\n          {\n            type: PartType.TEXT_SELECTED,\n            value: line.slice(start - offset, end - offset),\n          },\n          {\n            type: PartType.TEXT,\n            value: line.slice(end - offset, line.length),\n          },\n        ];\n      }\n      // selection in other line\n      else {\n        parts = [\n          {\n            type: PartType.TEXT,\n            value: line,\n          },\n        ];\n      }\n    }\n\n    offset += line.length + 1;\n    return parts;\n  });\n\n  return lines.map((line: Line, lineIndex: number) => (\n    <div key={`line_${lineIndex}`}>\n      <code>\n        {line.map((part, partIndex: number) => (\n          <span key={`line_${lineIndex}_part_${partIndex}`}>\n            {showPart(part)}\n          </span>\n        ))}\n      </code>\n    </div>\n  ));\n};\n\nfunction TextPlayer({ editor }: TextPlayerProps) {\n  return (\n    <div className=\"text-player code\">\n      <pre\n        className=\"text-player__highlight\"\n        style={{ ...styles.editor, ...styles.highlight }}\n        {...{\n          dangerouslySetInnerHTML: {\n            __html: highlight(editor.content, languages.js) + \"<br />\",\n          },\n        }}\n      />\n      <pre\n        className=\"text-player__selection\"\n        style={{ ...styles.editor, ...styles.highlight }}\n        aria-hidden=\"true\"\n      >\n        {editor &&\n          showLines(\n            editor.content,\n            editor.selection.start,\n            editor.selection.end\n          )}\n      </pre>\n    </div>\n  );\n}\n\nexport default TextPlayer;\n","// https://github.com/Hector101/react-videojs-hook/blob/master/src/useVideojs.ts\nimport { useRef, useEffect } from \"react\";\nimport videojs, { VideoJsPlayer } from \"video.js\";\n\nimport usePrevious from \"../../util/usePrevious\";\n\ntype VideoJsPlayerPluginOptions = {\n  [pluginName: string]: any;\n};\n\ntype Props = {\n  src: string;\n  sources?: videojs.Tech.SourceObject[];\n  aspectRatio?: string;\n  autoplay?: boolean | string;\n  controlBar?: videojs.ControlBarOptions | false;\n  textTrackSettings?: videojs.TextTrackSettingsOptions;\n  controls?: boolean;\n  defaultVolume?: number;\n  fluid?: boolean;\n  responsive?: boolean;\n  width?: number;\n  height?: number;\n  html5?: any;\n  inactivityTimeout?: number;\n  language?: string;\n  languages?: { [code: string]: videojs.LanguageTranslations };\n  liveui?: boolean;\n  loop?: boolean;\n  muted?: boolean;\n  nativeControlsForTouch?: boolean;\n  notSupportedMessage?: string;\n  playbackRates?: number[];\n  plugins?: Partial<VideoJsPlayerPluginOptions>;\n  poster?: string;\n  preload?: string;\n  sourceOrder?: boolean;\n  techOrder?: string[];\n  tracks?: videojs.TextTrackOptions[];\n  hideControls?: string[];\n  bigPlayButton?: boolean;\n  bigPlayButtonCentered?: boolean;\n  onReady?: (player: VideoJsPlayer) => void;\n  onPlay?: (currentTime?: number) => void;\n  onPause?: (currentTime?: number) => void;\n  onTimeUpdate?: (currentTime: number) => void;\n  onSeeking?: (currentTime: number) => void;\n  onLoadedmetadata?: (totalTime: number) => void;\n  onSeeked?: (position: number, currentTime: number) => void;\n  onEnd?: (currentTime?: number) => void;\n};\n\nexport function useVideojs({\n  src,\n  autoplay,\n  onReady,\n  onPlay,\n  onPause,\n  onTimeUpdate,\n  onSeeking,\n  onLoadedmetadata,\n  onSeeked,\n  onEnd,\n  ...props\n}: Props) {\n  const videoNodeRef = useRef(null);\n\n  let player: VideoJsPlayer;\n\n  const previousSrc = usePrevious(src);\n  const previousAutoplay = usePrevious(autoplay);\n\n  useEffect(() => {\n    if (previousSrc !== src && !previousSrc) {\n      _initPlayer();\n      _initPlayerEvents();\n    }\n    if (previousSrc !== src && previousSrc) {\n      _changeSrc();\n      _unregisterEvents();\n      _initPlayerEvents();\n    }\n\n    if (previousAutoplay !== autoplay && previousAutoplay !== undefined) {\n      _changeAutoplay();\n      _unregisterEvents();\n      _initPlayerEvents();\n    }\n  }, [src, autoplay]);\n\n  const _initPlayer = () => {\n    player = videojs(videoNodeRef.current, props);\n    player.src(src);\n    player.autoplay(autoplay || false);\n  };\n\n  const _changeSrc = () => {\n    player = videojs(videoNodeRef.current);\n    player.src(src);\n  };\n\n  const _changeAutoplay = () => {\n    player = videojs(videoNodeRef.current);\n    player.autoplay(autoplay || false);\n  };\n\n  const _initPlayerEvents = () => {\n    let currentTime = 0;\n    let previousTime = 0;\n    let position = 0;\n\n    player.ready(() => {\n      if (onReady) {\n        onReady(player);\n      }\n    });\n\n    player.on(\"play\", () => {\n      if (onPlay) {\n        onPlay(player.currentTime());\n      }\n    });\n\n    player.on(\"pause\", () => {\n      if (onPause) {\n        onPause(player.currentTime());\n      }\n    });\n\n    player.on(\"timeupdate\", () => {\n      if (onTimeUpdate) {\n        onTimeUpdate(player.currentTime());\n        previousTime = currentTime;\n        currentTime = player.currentTime();\n        if (previousTime < currentTime) {\n          position = previousTime;\n          previousTime = currentTime;\n        }\n      }\n    });\n\n    player.on(\"seeking\", () => {\n      if (onSeeking) {\n        player.off(\"timeupdate\");\n        player.one(\"seeked\");\n        onSeeking(player.currentTime());\n      }\n    });\n\n    player.on(\"loadedmetadata\", () => {\n      if (onLoadedmetadata) {\n        onLoadedmetadata(player.duration());\n      }\n    });\n\n    player.on(\"seeked\", () => {\n      if (onSeeked) {\n        const completeTime = Math.floor(player.currentTime());\n        onSeeked(position, completeTime);\n      }\n    });\n\n    player.on(\"ended\", () => {\n      if (onEnd) {\n        onEnd(player.currentTime());\n      }\n    });\n  };\n\n  const _unregisterEvents = () => {\n    player.off(\"play\");\n    player.off(\"pause\");\n    player.off(\"timeupdate\");\n    player.off(\"seeking\");\n    player.off(\"seeked\");\n    player.off(\"ended\");\n  };\n\n  return { videoNodeRef };\n}\n","import React, { useContext, useState } from \"react\";\nimport \"./styles.css\";\nimport VideoPlayer from \"../VideoPlayer\";\nimport Preview from \"../Preview\";\nimport TextPlayer from \"../TextPlayer\";\nimport useFetch from \"../../util/useFetch\";\nimport { useParams } from \"react-router-dom\";\nimport { RouterParams } from \"../../index\";\nimport { URL } from \"../../util/api\";\n\nimport { EditorFrame } from \"../../context/session\";\nimport { Context as CourseContext } from \"../../context/course\";\n\n/**\n * Returns the index of the last element in the array where predicate is true, and -1\n * otherwise.\n * @param array The source array to search in\n * @param predicate find calls predicate once for each element of the array, in descending\n * order, until it finds one where predicate returns true. If such an element is found,\n * findLastIndex immediately returns that element index. Otherwise, findLastIndex returns -1.\n */\nexport function findLastIndex<T>(\n  array: Array<T>,\n  predicate: (value: T, index: number, obj: T[]) => boolean\n): number {\n  let l = array.length;\n  while (l--) {\n    if (predicate(array[l], l, array)) return l;\n  }\n  return -1;\n}\n\nfunction Player() {\n  const {\n    state: { lang },\n  } = useContext(CourseContext);\n  let { chapter, step } = useParams<RouterParams>();\n\n  const [pos, setPos] = useState(0);\n\n  // const pos = state.current.playPosition;\n\n  const { response: editorFrames, hasError } = useFetch<EditorFrame[]>(\n    URL.step({ chapter, step })\n  );\n\n  const editorFramePosPos = editorFrames\n    ? findLastIndex(editorFrames, (item) => item.time <= pos * 1000)\n    : 0;\n\n  const editorFramePos = editorFrames ? editorFrames[editorFramePosPos] : false;\n\n  return (\n    <div className=\"player\">\n      <div className=\"player__content\">\n        <div className=\"player__video\">\n          <VideoPlayer\n            onTimeUpdate={(t: number) => setPos(t)}\n            src={URL.movie({ chapter, step })}\n          />\n        </div>\n        <div className=\"player__code\">\n          {(!hasError && editorFramePos && (\n            <TextPlayer editor={editorFramePos.editor} />\n          )) || <span>{lang[\"video.error\"]}</span>}\n        </div>\n        <div className=\"player__preview\">\n          {!hasError && editorFramePos && (\n            <Preview code={editorFramePos.editor.content} hideErrors={true} />\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Player;\n","import \"prismjs/components/prism-clike\";\nimport { highlight, languages } from \"prismjs/components/prism-core\";\nimport \"prismjs/components/prism-javascript\";\nimport \"prismjs/themes/prism.css\"; //Example style, you can use another\nimport React, { useContext, useEffect, useRef } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport {\n  Action as SessionAction,\n  Context as SessionContext,\n  Selection,\n} from \"../../context/session\";\nimport { RouterParams } from \"../../index\";\nimport SimpleEditor from \"./editor\";\nimport \"./styles.css\";\n\nexport type editorProps = {\n  content: string;\n};\n\nconst Editor = ({ content }: editorProps) => {\n  const { dispatch } = useContext(SessionContext);\n  let { chapter, step } = useParams<RouterParams>();\n\n  const inputEl = useRef<HTMLTextAreaElement>(null);\n\n  useEffect(() => {\n    inputEl?.current?.focus();\n  }, []);\n\n  const pushValue = (value: string) => {\n    dispatch({\n      type: SessionAction.SET_EDITOR_CONTENT,\n      payload: {\n        chapter,\n        step,\n        value,\n      },\n    });\n  };\n\n  const pushSelection = (value: Selection) => {\n    dispatch({\n      type: SessionAction.SET_EDITOR_SELECTION,\n      payload: {\n        value,\n      },\n    });\n  };\n\n  // const handleInputChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n  //   pushValue(e.target.value);\n  // };\n  const handleInputChange = (val: string) => {\n    pushValue(val);\n  };\n\n  const handleSelection = (\n    e:\n      | React.MouseEvent<HTMLTextAreaElement>\n      | React.KeyboardEvent<HTMLTextAreaElement>\n  ) => {\n    const start = e.target.selectionStart || 0;\n    const end = e.target.selectionEnd || start;\n\n    pushSelection({ start, end });\n  };\n\n  // const handleSelection = (start: number, end: number) => {\n  //   console.log(\"handleSelection\", start, end);\n  //   pushSelection({ start, end });\n\n  //   // other code within selection handler as per original\n\n  //   // inputEl?.current?.focus();\n  //   // // the line below doesn't work!\n  //   // // inputEl?.current?.setSelectionRange(start + e.native.length, end + e.native.length)\n\n  //   // //this one does, but is not good practice..\n  //   // setTimeout(\n  //   //   () =>\n  //   //     inputEl?.current?.setSelectionRange(\n  //   //       start + e.native.length,\n  //   //       end + e.native.length\n  //   //     ),\n  //   //   10\n  //   // );\n  //   // setSelection({\n  //   //   start: start,\n  //   //   end: end,\n  //   // });\n  // };\n\n  // const handleKeyDown = (e: React.KeyboardEvent) => {\n  //   if (e.key == \"Tab\") {\n  //     e.preventDefault();\n  //     const el = inputEl?.current;\n  //     const start = el?.selectionStart || 0;\n  //     const end = el?.selectionEnd || start;\n\n  //     // set textarea value to: text before caret + tab + text after caret\n  //     const value =\n  //       el?.value.substring(0, start) + \"\\t\" + el?.value.substring(end);\n\n  //     pushValue(value);\n\n  //     // dispatch({\n  //     //   type: SessionAction.SET_EDITOR_CONTENT,\n  //     //   payload: {\n  //     //     value: value,\n  //     //   },\n  //     // });\n\n  //     // put caret at right position again\n  //     setSelection({ start: start + 1, end: end + 1 });\n  //   }\n  // };\n\n  const setFocus = () => {\n    dispatch({\n      type: SessionAction.SET_EDITOR_FOCUS,\n      payload: {\n        value: true,\n      },\n    });\n  };\n\n  const setBlur = () => {\n    dispatch({\n      type: SessionAction.SET_EDITOR_FOCUS,\n      payload: {\n        value: false,\n      },\n    });\n  };\n\n  return (\n    <div className=\"editor\">\n      <SimpleEditor\n        className=\"editor__editor code\"\n        preClassName=\"editor__textarea-pre\"\n        textareaClassName=\"editor__textarea-textarea\"\n        onFocus={setFocus}\n        onBlur={setBlur}\n        onSelect={handleSelection}\n        onValueChange={handleInputChange}\n        value={content}\n        highlight={(code) => highlight(code, languages.js)}\n        style={\n          {\n            // fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n            // fontSize: 12,\n          }\n        }\n      />\n    </div>\n  );\n};\n\nexport default Editor;\n","import React, { ReactNode } from \"react\";\nimport \"./styles.css\";\n\ntype ContentProps = {\n  children: ReactNode;\n  className?: string;\n};\n\nfunction Content({ children, className = \"\" }: ContentProps) {\n  return <div className={`content ${className}`}>{children}</div>;\n}\n\nexport default Content;\n","import React, { useContext, useEffect } from \"react\";\nimport WorkSpace from \"../WorkSpace\";\nimport Callout from \"../Callout\";\nimport StatusIcon from \"../StatusIcon\";\nimport Markdown from \"../Markdown\";\nimport useFetch from \"../../util/useFetch\";\nimport { RouterParams } from \"../../index\";\nimport { useParams } from \"react-router-dom\";\n\nimport \"./styles.css\";\nimport {\n  Context as SessionContext,\n  Action as SessionAction,\n} from \"../../context/session\";\nimport { Context as CourseContext } from \"../../context/course\";\n\nimport { Step, Chapter } from \"../../context/course\";\nimport { URL, ROUTE } from \"../../util/api\";\n\nimport CapterMenu from \"../CapterMenu\";\nimport StepMenu from \"../StepMenu\";\nimport Player from \"../Player\";\nimport Editor from \"../Editor\";\nimport Content from \"../Content\";\n\nexport function findNextIndex<T>(\n  array: Array<T>,\n  predicate: (value: T, index: number, obj: T[]) => boolean\n): number {\n  let l = array.length;\n\n  const index = array.findIndex(predicate);\n\n  if (index >= 0 && index < l - 1) {\n    return index + 1;\n  }\n\n  return -1;\n}\n\nfunction Viewer() {\n  const {\n    state: appState,\n    state: { lang },\n  } = useContext(CourseContext);\n  const { state, dispatch } = useContext(SessionContext);\n  let { chapter, step } = useParams<RouterParams>();\n\n  const chapterURL = URL.chapter({ chapter });\n  const { response: steps, loading, hasError } = useFetch<Step[]>(chapterURL);\n\n  const currentStepData = steps?.find((item) => item.id === step);\n\n  const currentStepProgress =\n    state.progress && state.progress[chapter]?.steps[step];\n\n  const isSolved = currentStepProgress?.done;\n\n  const content =\n    (state.progress && state.progress[chapter]?.steps[step]?.editor?.content) ||\n    \"\";\n\n  // find next step\n  let next = \"\";\n  const nextStepIndex =\n    (steps && findNextIndex<Step>(steps, (item) => item.id === step)) || 0;\n  if (steps && nextStepIndex > 0) {\n    next = ROUTE.step({ chapter, step: steps[nextStepIndex].id });\n  } else if (steps && chapter) {\n    const nextChapterIndex =\n      (appState.chapters &&\n        findNextIndex<Chapter>(\n          appState.chapters,\n          (item) => item.id === chapter\n        )) ||\n      0;\n\n    if (appState.chapters && nextChapterIndex > 0) {\n      next = ROUTE.chapterFirstStep({\n        chapter: appState.chapters[nextChapterIndex].id,\n      });\n    }\n  }\n\n  const solved = (finished: boolean) => {\n    if (isSolved !== finished) {\n      dispatch({\n        type: SessionAction.SET_CURRENT_STEP_PROGRESS,\n        payload: {\n          chapter,\n          step,\n          value: finished,\n        },\n      });\n\n      const completeSteps = steps?.filter((item) => {\n        if (item.id === step) {\n          return finished;\n        }\n        return (\n          state.progress &&\n          state.progress[chapter]?.steps[item.id] &&\n          state.progress[chapter]?.steps[item.id].done\n        );\n      });\n\n      const isChapterComplete = completeSteps?.length === steps?.length;\n\n      dispatch({\n        type: SessionAction.SET_CURRENT_CHAPTER_PROGRESS,\n        payload: {\n          chapter,\n          value: isChapterComplete,\n        },\n      });\n    }\n  };\n\n  useEffect(() => {\n    const match = currentStepData?.task.match;\n    if (match && content) {\n      const regexParts = match.match(new RegExp(\"^/(.*?)/([gimy]*)$\"));\n      if (regexParts?.length === 3) {\n        const regex = new RegExp(regexParts[1], regexParts[2]);\n\n        const finished = regex.test(content);\n\n        solved(finished);\n      }\n    }\n  }, [content]);\n\n  return (\n    <div className=\"viewer\">\n      <div className=\"viewer__chapter-menu\">\n        <CapterMenu />\n      </div>\n      <div className=\"viewer__content\">\n        <div className=\"viewer__step-menu\">\n          <div className=\"viewer__step-menu-inner\">\n            {steps && <StepMenu steps={steps} />}\n            {loading && <span> {lang[\"step.loading\"]}</span>}\n            {hasError && <span> {lang[\"step.error\"]}</span>}\n          </div>\n        </div>\n        <div className=\"viewer__step\">\n          <div className=\"viewer__teach\">\n            <Content className=\"viewer__teach-inner\">\n              <Player />\n            </Content>\n          </div>\n          <div className=\"viewer__task\">\n            <Content>\n              <Callout done={isSolved || false} next={next}>\n                <div className=\"viewer__task-text\">\n                  <h2>\n                    {isSolved && <StatusIcon />}\n                    {lang[\"step.task\"]}\n                  </h2>\n                  <p>\n                    {currentStepData && (\n                      <Markdown text={currentStepData.task.instruction} />\n                    )}\n                  </p>\n                </div>\n              </Callout>\n            </Content>\n          </div>\n          <div className=\"viewer__learn\">\n            <Content>\n              {!loading && (\n                <WorkSpace\n                  preview={currentStepProgress?.editor?.content || \"\"}\n                  check={currentStepData?.task.check}\n                  solved={solved}\n                  focus={state.current.editor.focus}\n                >\n                  <Editor content={content} />\n                </WorkSpace>\n              )}\n            </Content>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Viewer;\n","import React, { useContext } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { Context as SessionContext } from \"../../context/session\";\nimport { RouterParams } from \"../../index\";\nimport \"./styles.css\";\n\nfunction StepMenu() {\n  const { state } = useContext(SessionContext);\n  let { chapter, step } = useParams<RouterParams>();\n\n  const print = {\n    chapter: chapter,\n    step: step,\n    // progress: state.progress?.functions,\n    // progress_1: get(state.progress),\n    selection: `${state.current.editor.selection.start} – ${state.current.editor.selection.end}`,\n  };\n\n  return (\n    <div className=\"debug\">\n      <h3>Debug</h3>\n      <pre className=\"code\">\n        <code>{JSON.stringify(print, null, 2)}</code>\n      </pre>\n    </div>\n  );\n}\n\nexport default StepMenu;\n","import React from \"react\";\nimport \"./styles.css\";\n\ntype ButtonProps = {\n  children: React.ReactNode;\n  onClick: React.MouseEventHandler<HTMLButtonElement>;\n};\n\nconst Button = ({ children, onClick }: ButtonProps) => (\n  <button className=\"button\" onClick={onClick}>\n    {children}\n  </button>\n);\n\nexport default Button;\n","// https://areknawo.com/js-tidbits-mediastream-api/\n\n// @ts-nocheck\n\n// function createGist(opts) {\n//   ChromeSamples.log('Posting request to GitHub API...');\n// }\n// import React from \"react\";\nimport useMediaRecorder from \"@wmik/use-media-recorder\";\nimport { saveAs } from \"file-saver\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { Context as SessionContext } from \"../../context/session\";\nimport Button from \"../Button\";\nimport \"./styles.css\";\n\n\n\nfunction Player({ srcBlob, audio }) {\n  if (!srcBlob) {\n    return null;\n  }\n\n  if (audio) {\n    return <audio src={URL.createObjectURL(srcBlob)} controls />;\n  }\n\n  const handleStore = (event: React.MouseEvent<HTMLButtonElement>) => {\n    saveAs(srcBlob, \"film.webm\");\n  };\n\n  return (\n    <div>\n      <div>\n        <video\n          src={URL.createObjectURL(srcBlob)}\n          width={520}\n          height={293}\n          controls\n        />\n        <div>\n          <Button onClick={handleStore}>download</Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction LiveStreamPreview({ stream }) {\n  let videoPreviewRef = React.useRef();\n\n  React.useEffect(() => {\n    if (videoPreviewRef.current && stream) {\n      videoPreviewRef.current.srcObject = stream;\n    }\n  }, [stream]);\n\n  if (!stream) {\n    return null;\n  }\n\n  return <video ref={videoPreviewRef} width={520} height={293} autoPlay />;\n}\n\nlet start = 0;\nlet record = [];\n\nfunction Admin() {\n  const { state } = useContext(SessionContext);\n\n  const [recording, setRecording] = useState<boolean>(false);\n  const [preview, setPreview] = useState<boolean>(false);\n  let { chapter, step } = useParams<RouterParams>();\n\n  let {\n    error,\n    status,\n    mediaBlob,\n    stopRecording,\n    getMediaStream,\n    clearMediaStream,\n    startRecording,\n    liveStream,\n  } = useMediaRecorder({\n    // recordScreen: true,\n    blobOptions: {\n      // type: \"video/webm\",\n      type: \"video/webm;codecs=h264\",\n\n      // both for audio and video tracks\n      // bitsPerSecond: 128000,\n\n      // only for audio track\n      audioBitsPerSecond: 320000,\n\n      // only for video track\n      videoBitsPerSecond: 8000000,\n    },\n    mediaStreamConstraints: {\n      audio: true,\n      // video: true,\n      video: { width: 1920, height: 1080 },\n    },\n  });\n\n  useEffect(() => {\n    const now = Date.now();\n\n    record.push({\n      time: now - start,\n\n      editor: {\n        content: state.current.editor.content,\n        selection: {\n          start: state.current.editor.selection.start,\n          end: state.current.editor.selection.end,\n        },\n      },\n    });\n  }, [\n    state.current.editor.content,\n    state.current.editor.selection.start,\n    state.current.editor.selection.end,\n  ]);\n\n  const handleStop = (event: React.MouseEvent<HTMLButtonElement>) => {\n    stopRecording();\n    setRecording(false);\n\n    fetch(\"http://localhost:3005\", {\n      method: \"post\",\n      body: JSON.stringify({\n        chapter,\n        step,\n        content: JSON.stringify(record, null, 2),\n      }),\n    })\n      .then((response) => {\n        console.log(\"done text\");\n        // return response.json();\n      })\n      .then((e) => {\n        console.log(\"error text\", e);\n        // return response.json();\n      });\n\n    record = [];\n  };\n\n  // if (status === \"stopped\") {\n  //   fetch(`http://localhost:3005/media/${chapter}/${step}`, {\n  //     method: \"post\",\n  //     body: mediaBlob,\n  //   })\n  //     .then((response) => {\n  //       console.log(\"done video\");\n  //       // return response.json();\n  //     })\n  //     .then((e) => {\n  //       console.log(\"error video\", e);\n  //       // return response.json();\n  //     });\n  // }\n\n  useEffect(() => {\n    if (status === \"stopped\") {\n      var reader = new FileReader();\n      reader.readAsDataURL(mediaBlob);\n      reader.onloadend = function () {\n        var base64dataURI = reader.result.toString();\n        let base64data = base64dataURI.substr(base64dataURI.indexOf(\",\") + 1);\n        // console.log(base64data);\n\n        fetch(`http://localhost:3005/media/${chapter}/${step}`, {\n          method: \"post\",\n          // body: mediaBlob,\n          body: base64data,\n        })\n          .then((response) => {\n            console.log(\"done video\");\n            // return response.json();\n          })\n          .then((e) => {\n            console.log(\"error video\", e);\n            // return response.json();\n          });\n      };\n    }\n  }, [status]);\n\n  const handleRec = (event: React.MouseEvent<HTMLButtonElement>) => {\n    startRecording();\n    setRecording(true);\n    start = Date.now();\n    record = [];\n\n    record.push({\n      time: 0,\n\n      editor: {\n        content: state.current.editor.content,\n        selection: {\n          start: state.current.editor.selection.start,\n          end: state.current.editor.selection.end,\n        },\n      },\n    });\n  };\n\n  const handleStartPreview = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setPreview(true);\n    getMediaStream();\n  };\n  const handleStopPreview = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setPreview(false);\n    clearMediaStream();\n  };\n\n  return (\n    <div className=\"admin\">\n      <h3>Recorder</h3>\n      <p>{error ? `${status} ${error.message}` : status}</p>\n      <div className=\"admin__preview\">\n        <div className=\"admin__preview-btn\">\n          {(!preview && (\n            <button type=\"button\" onClick={handleStartPreview}>\n              Preview\n            </button>\n          )) || (\n            <button type=\"button\" onClick={handleStopPreview}>\n              Stop Preview\n            </button>\n          )}\n        </div>\n        <div className=\"admin__preview-screen\">\n          <svg\n            width=\"16\"\n            height=\"9\"\n            viewBox=\"0 0 16 9\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              clipRule=\"evenodd\"\n              d=\"M8.5 0H0V9H8.5H16V0H8.5ZM8.5 0C10.9853 0 13 2.01472 13 4.5C13 6.98528 10.9853 9 8.5 9C6.01472 9 4 6.98528 4 4.5C4 2.01472 6.01472 0 8.5 0Z\"\n              fill=\"black\"\n              fillOpacity=\"0.7\"\n            />\n          </svg>\n\n          <LiveStreamPreview stream={liveStream} />\n        </div>\n      </div>\n      <Player srcBlob={mediaBlob} />\n\n      {(!recording && (\n        <Button onClick={(e) => handleRec(e)}>Record</Button>\n      )) || <Button onClick={(e) => handleStop(e)}>Stop</Button>}\n    </div>\n  );\n}\n\nexport default Admin;\n","import React from \"react\";\nimport \"./styles.css\";\n\n// const options = {\n//   year: \"numeric\",\n//   month: \"long\",\n//   day: \"numeric\",\n// };\n\n// const options = {\n\n//   year: 'numeric',\n//   month: 'numeric',\n//   day: 'numeric',\n//   hour: '2-digit',\n//   minute: '2-digit',\n// }\n\nconst version = new Intl.DateTimeFormat(\"de-DE\", {\n  year: \"numeric\",\n  month: \"numeric\",\n  day: \"numeric\",\n  hour: \"2-digit\",\n  minute: \"2-digit\",\n})\n  .format(new Date(parseInt(process.env.REACT_APP_BUILD_TIME, 10) * 1000))\n  .replace(\",\", \"\");\n\nfunction Version() {\n  return <div className=\"version\">Version {version}</div>;\n}\n\nexport default Version;\n","import React, { useContext } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport Markdown from \"../Markdown\";\nimport { Context as CourseContext } from \"../../context/course\";\n\nimport \"./styles.css\";\n\nconst Home = () => {\n  const {\n    state: { lang },\n  } = useContext(CourseContext);\n\n  return (\n    <div className=\"home\">\n      <div className=\"home__inner\">\n        <h1 className=\"home__title\">{lang[\"intro.title\"]}</h1>\n        <p className=\"home__intro inline-link\">\n          <Markdown text={lang[\"intro.text\"]} />\n        </p>\n        <div className=\"home__cta\">\n          <Link className=\"home__btn\" to={lang[\"intro.link\"]}>\n            <em>{lang[\"intro.btn\"]}</em>\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Home;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport \"./fontello/css/fontello.css\";\nimport Viewer from \"./Components/Viewer\";\nimport Debug from \"./Components/Debug\";\nimport Admin from \"./Components/Admin\";\nimport Version from \"./Components/Version\";\nimport Home from \"./Components/Home\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\n\n// setup Provider\n\nimport { Provider as SessionProvider } from \"./context/session\";\nimport { Provider as CourseProvider } from \"./context/course\";\n\nexport interface RouterParams {\n  chapter: string;\n  step: string;\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <CourseProvider>\n      <SessionProvider>\n        <Router>\n          <div className=\"container\">\n            <Switch>\n              <Route exact path=\"/\">\n                <Home />\n              </Route>\n              <Route path=\"/course/js/basic/:chapter/:step\">\n                <Viewer />\n\n                {process.env.REACT_APP_DEV && (\n                  <>\n                    <Debug />\n                    <Admin />\n                  </>\n                )}\n              </Route>\n            </Switch>\n\n            <Version />\n          </div>\n        </Router>\n      </SessionProvider>\n    </CourseProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","/* @flow */\n/* global global */\n\nimport * as React from \"react\";\n\ntype Props = React.ElementConfig<\"div\"> & {\n  // Props for the component\n  value: string,\n  onValueChange: (value: string) => mixed,\n  onSelect: (e: object) => mixed,\n  highlight: (value: string) => string | React.Node,\n  tabSize: number,\n  insertSpaces: boolean,\n  ignoreTabKey: boolean,\n  padding: number | string,\n  style?: {},\n\n  // Props for the textarea\n  textareaId?: string,\n  textareaClassName?: string,\n  autoFocus?: boolean,\n  disabled?: boolean,\n  form?: string,\n  maxLength?: number,\n  minLength?: number,\n  name?: string,\n  placeholder?: string,\n  readOnly?: boolean,\n  required?: boolean,\n  onClick?: (e: MouseEvent) => mixed,\n  onFocus?: (e: FocusEvent) => mixed,\n  onBlur?: (e: FocusEvent) => mixed,\n  onKeyUp?: (e: KeyboardEvent) => mixed,\n  onKeyDown?: (e: KeyboardEvent) => mixed,\n\n  // Props for the hightlighted code’s pre element\n  preClassName?: string,\n};\n\ntype State = {\n  capture: boolean,\n};\n\ntype Record = {\n  value: string,\n  selectionStart: number,\n  selectionEnd: number,\n};\n\ntype History = {\n  stack: Array<Record & { timestamp: number }>,\n  offset: number,\n};\n\nconst KEYCODE_ENTER = 13;\nconst KEYCODE_TAB = 9;\nconst KEYCODE_BACKSPACE = 8;\nconst KEYCODE_Y = 89;\nconst KEYCODE_Z = 90;\nconst KEYCODE_M = 77;\nconst KEYCODE_PARENS = 57;\nconst KEYCODE_BRACKETS = 219;\nconst KEYCODE_QUOTE = 222;\nconst KEYCODE_BACK_QUOTE = 192;\nconst KEYCODE_ESCAPE = 27;\n\nconst HISTORY_LIMIT = 100;\nconst HISTORY_TIME_GAP = 3000;\n\nconst isWindows = \"navigator\" in global && /Win/i.test(navigator.platform);\nconst isMacLike =\n  \"navigator\" in global && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);\n\nconst className = \"npm__react-simple-code-editor__textarea\";\n\nconst cssText = /* CSS */ `\n/**\n * Reset the text fill color so that placeholder is visible\n */\n.${className}:empty {\n  -webkit-text-fill-color: inherit !important;\n}\n\n/**\n * Hack to apply on some CSS on IE10 and IE11\n */\n@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {\n  /**\n    * IE doesn't support '-webkit-text-fill-color'\n    * So we use 'color: transparent' to make the text transparent on IE\n    * Unlike other browsers, it doesn't affect caret color in IE\n    */\n  .${className} {\n    color: transparent !important;\n  }\n\n  .${className}::selection {\n    background-color: #accef7 !important;\n    color: transparent !important;\n  }\n}\n`;\n\nexport default class Editor extends React.Component<Props, State> {\n  static defaultProps = {\n    tabSize: 2,\n    insertSpaces: true,\n    ignoreTabKey: false,\n    padding: 0,\n  };\n\n  state = {\n    capture: true,\n  };\n\n  componentDidMount() {\n    this._recordCurrentState();\n  }\n\n  _recordCurrentState = () => {\n    const input = this._input;\n\n    if (!input) return;\n\n    // Save current state of the input\n    const { value, selectionStart, selectionEnd } = input;\n\n    this._recordChange({\n      value,\n      selectionStart,\n      selectionEnd,\n    });\n  };\n\n  _getLines = (text: string, position: number) =>\n    text.substring(0, position).split(\"\\n\");\n\n  _recordChange = (record: Record, overwrite?: boolean = false) => {\n    const { stack, offset } = this._history;\n\n    if (stack.length && offset > -1) {\n      // When something updates, drop the redo operations\n      this._history.stack = stack.slice(0, offset + 1);\n\n      // Limit the number of operations to 100\n      const count = this._history.stack.length;\n\n      if (count > HISTORY_LIMIT) {\n        const extras = count - HISTORY_LIMIT;\n\n        this._history.stack = stack.slice(extras, count);\n        this._history.offset = Math.max(this._history.offset - extras, 0);\n      }\n    }\n\n    const timestamp = Date.now();\n\n    if (overwrite) {\n      const last = this._history.stack[this._history.offset];\n\n      if (last && timestamp - last.timestamp < HISTORY_TIME_GAP) {\n        // A previous entry exists and was in short interval\n\n        // Match the last word in the line\n        const re = /[^a-z0-9]([a-z0-9]+)$/i;\n\n        // Get the previous line\n        const previous = this._getLines(last.value, last.selectionStart)\n          .pop()\n          .match(re);\n\n        // Get the current line\n        const current = this._getLines(record.value, record.selectionStart)\n          .pop()\n          .match(re);\n\n        if (previous && current && current[1].startsWith(previous[1])) {\n          // The last word of the previous line and current line match\n          // Overwrite previous entry so that undo will remove whole word\n          this._history.stack[this._history.offset] = { ...record, timestamp };\n\n          return;\n        }\n      }\n    }\n\n    // Add the new operation to the stack\n    this._history.stack.push({ ...record, timestamp });\n    this._history.offset++;\n  };\n\n  _updateInput = (record: Record) => {\n    const input = this._input;\n\n    if (!input) return;\n\n    // Update values and selection state\n    input.value = record.value;\n    input.selectionStart = record.selectionStart;\n    input.selectionEnd = record.selectionEnd;\n\n    this.props.onValueChange(record.value);\n  };\n\n  _applyEdits = (record: Record) => {\n    // Save last selection state\n    const input = this._input;\n    const last = this._history.stack[this._history.offset];\n\n    if (last && input) {\n      this._history.stack[this._history.offset] = {\n        ...last,\n        selectionStart: input.selectionStart,\n        selectionEnd: input.selectionEnd,\n      };\n    }\n\n    // Save the changes\n    this._recordChange(record);\n    this._updateInput(record);\n  };\n\n  _undoEdit = () => {\n    const { stack, offset } = this._history;\n\n    // Get the previous edit\n    const record = stack[offset - 1];\n\n    if (record) {\n      // Apply the changes and update the offset\n      this._updateInput(record);\n      this._history.offset = Math.max(offset - 1, 0);\n    }\n  };\n\n  _redoEdit = () => {\n    const { stack, offset } = this._history;\n\n    // Get the next edit\n    const record = stack[offset + 1];\n\n    if (record) {\n      // Apply the changes and update the offset\n      this._updateInput(record);\n      this._history.offset = Math.min(offset + 1, stack.length - 1);\n    }\n  };\n\n  _handleKeyDown = (e: *) => {\n    const { tabSize, insertSpaces, ignoreTabKey, onKeyDown } = this.props;\n\n    if (onKeyDown) {\n      onKeyDown(e);\n\n      if (e.defaultPrevented) {\n        return;\n      }\n    }\n\n    if (e.keyCode === KEYCODE_ESCAPE) {\n      e.target.blur();\n    }\n\n    const { value, selectionStart, selectionEnd } = e.target;\n\n    const tabCharacter = (insertSpaces ? \" \" : \"\\t\").repeat(tabSize);\n\n    if (e.keyCode === KEYCODE_TAB && !ignoreTabKey && this.state.capture) {\n      // Prevent focus change\n      e.preventDefault();\n\n      if (e.shiftKey) {\n        // Unindent selected lines\n        const linesBeforeCaret = this._getLines(value, selectionStart);\n        const startLine = linesBeforeCaret.length - 1;\n        const endLine = this._getLines(value, selectionEnd).length - 1;\n        const nextValue = value\n          .split(\"\\n\")\n          .map((line, i) => {\n            if (\n              i >= startLine &&\n              i <= endLine &&\n              line.startsWith(tabCharacter)\n            ) {\n              return line.substring(tabCharacter.length);\n            }\n\n            return line;\n          })\n          .join(\"\\n\");\n\n        if (value !== nextValue) {\n          const startLineText = linesBeforeCaret[startLine];\n\n          this._applyEdits({\n            value: nextValue,\n            // Move the start cursor if first line in selection was modified\n            // It was modified only if it started with a tab\n            selectionStart: startLineText.startsWith(tabCharacter)\n              ? selectionStart - tabCharacter.length\n              : selectionStart,\n            // Move the end cursor by total number of characters removed\n            selectionEnd: selectionEnd - (value.length - nextValue.length),\n          });\n        }\n      } else if (selectionStart !== selectionEnd) {\n        // Indent selected lines\n        const linesBeforeCaret = this._getLines(value, selectionStart);\n        const startLine = linesBeforeCaret.length - 1;\n        const endLine = this._getLines(value, selectionEnd).length - 1;\n        const startLineText = linesBeforeCaret[startLine];\n\n        this._applyEdits({\n          value: value\n            .split(\"\\n\")\n            .map((line, i) => {\n              if (i >= startLine && i <= endLine) {\n                return tabCharacter + line;\n              }\n\n              return line;\n            })\n            .join(\"\\n\"),\n          // Move the start cursor by number of characters added in first line of selection\n          // Don't move it if it there was no text before cursor\n          selectionStart: /\\S/.test(startLineText)\n            ? selectionStart + tabCharacter.length\n            : selectionStart,\n          // Move the end cursor by total number of characters added\n          selectionEnd:\n            selectionEnd + tabCharacter.length * (endLine - startLine + 1),\n        });\n      } else {\n        const updatedSelection = selectionStart + tabCharacter.length;\n\n        this._applyEdits({\n          // Insert tab character at caret\n          value:\n            value.substring(0, selectionStart) +\n            tabCharacter +\n            value.substring(selectionEnd),\n          // Update caret position\n          selectionStart: updatedSelection,\n          selectionEnd: updatedSelection,\n        });\n      }\n    } else if (e.keyCode === KEYCODE_BACKSPACE) {\n      const hasSelection = selectionStart !== selectionEnd;\n      const textBeforeCaret = value.substring(0, selectionStart);\n\n      if (textBeforeCaret.endsWith(tabCharacter) && !hasSelection) {\n        // Prevent default delete behaviour\n        e.preventDefault();\n\n        const updatedSelection = selectionStart - tabCharacter.length;\n\n        this._applyEdits({\n          // Remove tab character at caret\n          value:\n            value.substring(0, selectionStart - tabCharacter.length) +\n            value.substring(selectionEnd),\n          // Update caret position\n          selectionStart: updatedSelection,\n          selectionEnd: updatedSelection,\n        });\n      }\n    } else if (e.keyCode === KEYCODE_ENTER) {\n      // Ignore selections\n      if (selectionStart === selectionEnd) {\n        // Get the current line\n        const line = this._getLines(value, selectionStart).pop();\n        const matches = line.match(/^\\s+/);\n\n        if (matches && matches[0]) {\n          e.preventDefault();\n\n          // Preserve indentation on inserting a new line\n          const indent = \"\\n\" + matches[0];\n          const updatedSelection = selectionStart + indent.length;\n\n          this._applyEdits({\n            // Insert indentation character at caret\n            value:\n              value.substring(0, selectionStart) +\n              indent +\n              value.substring(selectionEnd),\n            // Update caret position\n            selectionStart: updatedSelection,\n            selectionEnd: updatedSelection,\n          });\n        }\n      }\n    } else if (\n      e.keyCode === KEYCODE_PARENS ||\n      e.keyCode === KEYCODE_BRACKETS ||\n      e.keyCode === KEYCODE_QUOTE ||\n      e.keyCode === KEYCODE_BACK_QUOTE\n    ) {\n      let chars;\n\n      if (e.keyCode === KEYCODE_PARENS && e.shiftKey) {\n        chars = [\"(\", \")\"];\n      } else if (e.keyCode === KEYCODE_BRACKETS) {\n        if (e.shiftKey) {\n          chars = [\"{\", \"}\"];\n        } else {\n          chars = [\"[\", \"]\"];\n        }\n      } else if (e.keyCode === KEYCODE_QUOTE) {\n        if (e.shiftKey) {\n          chars = ['\"', '\"'];\n        } else {\n          chars = [\"'\", \"'\"];\n        }\n      } else if (e.keyCode === KEYCODE_BACK_QUOTE && !e.shiftKey) {\n        chars = [\"`\", \"`\"];\n      }\n\n      // If text is selected, wrap them in the characters\n      if (selectionStart !== selectionEnd && chars) {\n        e.preventDefault();\n\n        this._applyEdits({\n          value:\n            value.substring(0, selectionStart) +\n            chars[0] +\n            value.substring(selectionStart, selectionEnd) +\n            chars[1] +\n            value.substring(selectionEnd),\n          // Update caret position\n          selectionStart,\n          selectionEnd: selectionEnd + 2,\n        });\n      }\n    } else if (\n      (isMacLike\n        ? // Trigger undo with ⌘+Z on Mac\n          e.metaKey && e.keyCode === KEYCODE_Z\n        : // Trigger undo with Ctrl+Z on other platforms\n          e.ctrlKey && e.keyCode === KEYCODE_Z) &&\n      !e.shiftKey &&\n      !e.altKey\n    ) {\n      e.preventDefault();\n\n      this._undoEdit();\n    } else if (\n      (isMacLike\n        ? // Trigger redo with ⌘+Shift+Z on Mac\n          e.metaKey && e.keyCode === KEYCODE_Z && e.shiftKey\n        : isWindows\n        ? // Trigger redo with Ctrl+Y on Windows\n          e.ctrlKey && e.keyCode === KEYCODE_Y\n        : // Trigger redo with Ctrl+Shift+Z on other platforms\n          e.ctrlKey && e.keyCode === KEYCODE_Z && e.shiftKey) &&\n      !e.altKey\n    ) {\n      e.preventDefault();\n\n      this._redoEdit();\n    } else if (\n      e.keyCode === KEYCODE_M &&\n      e.ctrlKey &&\n      (isMacLike ? e.shiftKey : true)\n    ) {\n      e.preventDefault();\n\n      // Toggle capturing tab key so users can focus away\n      this.setState((state) => ({\n        capture: !state.capture,\n      }));\n    }\n  };\n\n  _handleChange = (e: *) => {\n    const { value, selectionStart, selectionEnd } = e.target;\n\n    this._recordChange(\n      {\n        value,\n        selectionStart,\n        selectionEnd,\n      },\n      true\n    );\n\n    this.props.onValueChange(value);\n  };\n\n  _history: History = {\n    stack: [],\n    offset: -1,\n  };\n\n  _input: ?HTMLTextAreaElement;\n\n  get session() {\n    return {\n      history: this._history,\n    };\n  }\n\n  set session(session: { history: History }) {\n    this._history = session.history;\n  }\n\n  render() {\n    const {\n      value,\n      style,\n      padding,\n      highlight,\n      textareaId,\n      textareaClassName,\n      autoFocus,\n      disabled,\n      form,\n      maxLength,\n      minLength,\n      name,\n      placeholder,\n      readOnly,\n      required,\n      onClick,\n      onFocus,\n      onBlur,\n      onKeyUp,\n      /* eslint-disable no-unused-vars */\n      onKeyDown,\n      onValueChange,\n      onSelect,\n      tabSize,\n      insertSpaces,\n      ignoreTabKey,\n      /* eslint-enable no-unused-vars */\n      preClassName,\n      ...rest\n    } = this.props;\n\n    const contentStyle = {\n      paddingTop: padding,\n      paddingRight: padding,\n      paddingBottom: padding,\n      paddingLeft: padding,\n    };\n\n    const highlighted = highlight(value);\n\n    return (\n      <div {...rest} style={{ ...styles.container, ...style }}>\n        <textarea\n          ref={(c) => (this._input = c)}\n          style={{\n            ...styles.editor,\n            ...styles.textarea,\n            ...contentStyle,\n          }}\n          className={\n            className + (textareaClassName ? ` ${textareaClassName}` : \"\")\n          }\n          id={textareaId}\n          value={value}\n          onChange={this._handleChange}\n          onSelect={onSelect}\n          onKeyDown={this._handleKeyDown}\n          onClick={onClick}\n          onKeyUp={onKeyUp}\n          onFocus={onFocus}\n          onBlur={onBlur}\n          disabled={disabled}\n          form={form}\n          maxLength={maxLength}\n          minLength={minLength}\n          name={name}\n          placeholder={placeholder}\n          readOnly={readOnly}\n          required={required}\n          autoFocus={autoFocus}\n          autoCapitalize=\"off\"\n          autoComplete=\"off\"\n          autoCorrect=\"off\"\n          spellCheck={false}\n          data-gramm={false}\n        />\n        <pre\n          className={preClassName}\n          aria-hidden=\"true\"\n          style={{ ...styles.editor, ...styles.highlight, ...contentStyle }}\n          {...(typeof highlighted === \"string\"\n            ? { dangerouslySetInnerHTML: { __html: highlighted + \"<br />\" } }\n            : { children: highlighted })}\n        />\n        {/* eslint-disable-next-line react/no-danger */}\n        <style type=\"text/css\" dangerouslySetInnerHTML={{ __html: cssText }} />\n      </div>\n    );\n  }\n}\n\nexport const styles = {\n  container: {\n    position: \"relative\",\n    textAlign: \"left\",\n    boxSizing: \"border-box\",\n    padding: 0,\n    overflow: \"hidden\",\n  },\n  textarea: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    height: \"100%\",\n    width: \"100%\",\n    resize: \"none\",\n    color: \"inherit\",\n    overflow: \"hidden\",\n    MozOsxFontSmoothing: \"grayscale\",\n    WebkitFontSmoothing: \"antialiased\",\n    WebkitTextFillColor: \"transparent\",\n  },\n  highlight: {\n    position: \"relative\",\n    pointerEvents: \"none\",\n  },\n  editor: {\n    margin: 0,\n    border: 0,\n    background: \"none\",\n    boxSizing: \"inherit\",\n    display: \"inherit\",\n    fontFamily: \"inherit\",\n    fontSize: \"inherit\",\n    fontStyle: \"inherit\",\n    fontVariantLigatures: \"inherit\",\n    fontWeight: \"inherit\",\n    letterSpacing: \"inherit\",\n    lineHeight: \"inherit\",\n    tabSize: \"inherit\",\n    textIndent: \"inherit\",\n    textRendering: \"inherit\",\n    textTransform: \"inherit\",\n    whiteSpace: \"pre-wrap\",\n    wordBreak: \"keep-all\",\n    overflowWrap: \"break-word\",\n  },\n};\n"],"sourceRoot":""}